<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lecture 02: Heritability, segregation, and the gene-mapping toolkit – Statistical Genetics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../course_logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-8991b0faf62225856095ff2fe360da1f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Lecture 02: Heritability, segregation, and the gene-mapping toolkit</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../course_logo.png" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none">
      <img src="../course_logo.png" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><i class="bi bi-calendar" role="img">
</i> 
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link"><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../faq.html" class="sidebar-item-text sidebar-link"><i class="bi bi-question" role="img">
</i> 
 <span class="menu-text">FAQ</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../links.html" class="sidebar-item-text sidebar-link"><i class="bi bi-link" role="img">
</i> 
 <span class="menu-text">Useful Links</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://github.com/gwcbi/StatGen" class="sidebar-item-text sidebar-link" target="_blank"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text">GitHub</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://www.zotero.org/groups/6113424/pubh-8878/library" class="sidebar-item-text sidebar-link" target="_blank"><i class="bi bi-book" role="img">
</i> 
 <span class="menu-text">Zotero Library</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#agenda" id="toc-agenda" class="nav-link active" data-scroll-target="#agenda">Agenda</a></li>
  <li><a href="#mle-essentials" id="toc-mle-essentials" class="nav-link" data-scroll-target="#mle-essentials">MLE essentials</a></li>
  <li><a href="#lrt-unrestricted-vs-restricted-mle" id="toc-lrt-unrestricted-vs-restricted-mle" class="nav-link" data-scroll-target="#lrt-unrestricted-vs-restricted-mle">LRT (unrestricted vs restricted MLE)</a></li>
  <li><a href="#aggregation-heritability-and-segregation-analyses" id="toc-aggregation-heritability-and-segregation-analyses" class="nav-link" data-scroll-target="#aggregation-heritability-and-segregation-analyses">Aggregation, heritability, and segregation analyses</a></li>
  <li><a href="#a-gap-in-estimation" id="toc-a-gap-in-estimation" class="nav-link" data-scroll-target="#a-gap-in-estimation">A gap in estimation</a></li>
  <li><a href="#discussion" id="toc-discussion" class="nav-link" data-scroll-target="#discussion">Discussion</a></li>
  <li><a href="#heritability-first-principles" id="toc-heritability-first-principles" class="nav-link" data-scroll-target="#heritability-first-principles">Heritability, first principles</a></li>
  <li><a href="#heritability-first-principles-1" id="toc-heritability-first-principles-1" class="nav-link" data-scroll-target="#heritability-first-principles-1">Heritability, first principles</a></li>
  <li><a href="#estimating-h2-from-relatives-marker-free" id="toc-estimating-h2-from-relatives-marker-free" class="nav-link" data-scroll-target="#estimating-h2-from-relatives-marker-free">Estimating <span class="math inline">\(h^2\)</span> from relatives (marker-free)</a>
  <ul class="collapse">
  <li><a href="#parent-offspring-regression" id="toc-parent-offspring-regression" class="nav-link" data-scroll-target="#parent-offspring-regression">Parent-offspring regression</a></li>
  </ul></li>
  <li><a href="#estimating-h2-from-relatives-marker-free-1" id="toc-estimating-h2-from-relatives-marker-free-1" class="nav-link" data-scroll-target="#estimating-h2-from-relatives-marker-free-1">Estimating <span class="math inline">\(h^2\)</span> from relatives (marker-free)</a>
  <ul class="collapse">
  <li><a href="#parent-offspring-regression-1" id="toc-parent-offspring-regression-1" class="nav-link" data-scroll-target="#parent-offspring-regression-1">Parent-offspring regression</a></li>
  </ul></li>
  <li><a href="#estimating-h2-from-relatives-marker-free-2" id="toc-estimating-h2-from-relatives-marker-free-2" class="nav-link" data-scroll-target="#estimating-h2-from-relatives-marker-free-2">Estimating <span class="math inline">\(h^2\)</span> from relatives (marker-free)</a>
  <ul class="collapse">
  <li><a href="#twin-studies" id="toc-twin-studies" class="nav-link" data-scroll-target="#twin-studies">Twin Studies</a></li>
  </ul></li>
  <li><a href="#pedigree-variance-components-continuous-traits" id="toc-pedigree-variance-components-continuous-traits" class="nav-link" data-scroll-target="#pedigree-variance-components-continuous-traits">Pedigree variance components (continuous traits)</a></li>
  <li><a href="#binary-traits-via-the-liability-threshold-model" id="toc-binary-traits-via-the-liability-threshold-model" class="nav-link" data-scroll-target="#binary-traits-via-the-liability-threshold-model">Binary traits via the liability-threshold model</a></li>
  <li><a href="#probit-view-and-logistic-note" id="toc-probit-view-and-logistic-note" class="nav-link" data-scroll-target="#probit-view-and-logistic-note">Probit view and logistic note</a></li>
  <li><a href="#observed-vs.-liability-scale-h2" id="toc-observed-vs.-liability-scale-h2" class="nav-link" data-scroll-target="#observed-vs.-liability-scale-h2">Observed vs.&nbsp;liability-scale <span class="math inline">\(h^2\)</span></a></li>
  <li><a href="#ascertainment-as-conditioning-truncation-view" id="toc-ascertainment-as-conditioning-truncation-view" class="nav-link" data-scroll-target="#ascertainment-as-conditioning-truncation-view">Ascertainment as conditioning (truncation view)</a></li>
  <li><a href="#segregation-analysis-no-markers" id="toc-segregation-analysis-no-markers" class="nav-link" data-scroll-target="#segregation-analysis-no-markers">Segregation analysis (no markers)</a></li>
  <li><a href="#summary-key-takeaways" id="toc-summary-key-takeaways" class="nav-link" data-scroll-target="#summary-key-takeaways">Summary &amp; key takeaways</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="lecture-02.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lecture 02: Heritability, segregation, and the gene-mapping toolkit</h1>
<p class="subtitle lead">PUBH 8878, Statistical Genetics</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="agenda" class="level2">
<h2 class="anchored" data-anchor-id="agenda">Agenda</h2>
<ul>
<li>MLE Review</li>
<li>Narrow-and broad-sense heritability: definitions and interpretation</li>
<li>Estimating <span class="math inline">\(h^2\)</span> from pedigrees</li>
<li>Variance components via pedigrees (LMM with <span class="math inline">\(A\)</span>-matrix)</li>
<li>Binary traits: liability-threshold, observed vs.&nbsp;liability scales</li>
<li>Familial aggregation for binary traits: <span class="math inline">\(\lambda_R\)</span> (concept <span class="math inline">\(\rightarrow\)</span> model)</li>
<li>Segregation analysis: modeling inheritance without markers</li>
<li>Ascertainment as conditioning (truncation viewpoint)</li>
</ul>
</section>
<section id="mle-essentials" class="level2">
<h2 class="anchored" data-anchor-id="mle-essentials">MLE essentials</h2>
<div class="columns">
<div class="column" style="width:56%;">
<ul>
<li><p>Probability vs Likelihood:<br>
<span class="math inline">\(L(\theta\mid y)\propto p(y\mid\theta)\)</span> (fix <span class="math inline">\(y\)</span>, vary <span class="math inline">\(\theta\)</span>).</p></li>
<li><p>Log-likelihood / score / information:<br>
<span class="math inline">\(\ell(\theta)=\sum_i \log p(y_i\mid\theta)\)</span>,<br>
<span class="math inline">\(S(\theta)=\partial\ell/\partial\theta\)</span>,<br>
<span class="math inline">\(I(\theta)=-\partial^2\ell/\partial\theta\partial\theta^\top\)</span>.</p></li>
<li><p>MLE: <span class="math inline">\(\hat\theta=\arg\max_\theta \ell(\theta)\)</span>.</p></li>
<li><p>Large-sample:<br>
<span class="math inline">\(\hat\theta \approx \mathcal N\!\big(\theta_0,\; i(\theta_0)^{-1}\big)\)</span>,<br>
<span class="math inline">\(i(\theta)=\mathbb E[I(\theta\mid Y)]\)</span>.<br>
Invariance: MLE of <span class="math inline">\(g(\theta)\)</span> is <span class="math inline">\(g(\hat\theta)\)</span>.</p></li>
</ul>
</div><div class="column" style="width:44%;">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Regression as a likelihood<br>
If <span class="math inline">\(e\sim\mathcal N(0,\sigma^2 I)\)</span>, then OLS <span class="math inline">\(=\)</span> MLE for <span class="math inline">\(\beta\)</span>;<br>
<span class="math inline">\(\hat\sigma^2=\tfrac{1}{n}\sum \hat e_i^2\)</span>.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pitfalls<br>
Non-unique maxima, flat ridges, boundary solutions, small-sample failures of asymptotics.</p>
</div>
</div>
</div>
</div>
</section>
<section id="lrt-unrestricted-vs-restricted-mle" class="level2">
<h2 class="anchored" data-anchor-id="lrt-unrestricted-vs-restricted-mle">LRT (unrestricted vs restricted MLE)</h2>
<ul>
<li>Goal: test <span class="math inline">\(H_0\!:\,\theta=\theta_0\)</span> in a model with log-likelihood <span class="math inline">\(\ell(\theta,\eta)\)</span> and nuisance <span class="math inline">\(\eta\)</span>.</li>
<li>Unrestricted MLE: <span class="math inline">\((\hat\theta,\hat\eta) = \arg\max_{\theta,\eta} \ell(\theta,\eta)\)</span>.</li>
<li>Restricted MLE under <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\hat\eta_0 = \arg\max_{\eta} \ell(\theta_0,\eta)\)</span>.</li>
<li>Test statistic (fit improvement): <span class="math inline">\(\Lambda = 2\{\ell(\hat\theta,\hat\eta) - \ell(\theta_0,\hat\eta_0)\}\)</span>.</li>
<li>Interpretation: how much better the unrestricted fit is than the restricted fit; large values argue against <span class="math inline">\(H_0\)</span>.</li>
<li>Asymptotics: <span class="math inline">\(\Lambda \overset{d}{\to} \chi^2_q\)</span> with <span class="math inline">\(q\)</span> constraints (here <span class="math inline">\(q{=}1\)</span>). p-value: <span class="math inline">\(1-F_{\chi^2_q}(\Lambda)\)</span>.</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Variance-component caveat<br>
When testing a variance component <span class="math inline">\(\sigma^2=0\)</span> (boundary), the LRT null is a mixture (e.g., <span class="math inline">\(\tfrac{1}{2}\chi^2_0 + \tfrac{1}{2}\chi^2_1\)</span>); standard <span class="math inline">\(\chi^2\)</span> reference is invalid. Restricted LRTs or score tests are common alternatives.</p>
</div>
</div>
</section>
<section id="aggregation-heritability-and-segregation-analyses" class="level2">
<h2 class="anchored" data-anchor-id="aggregation-heritability-and-segregation-analyses">Aggregation, heritability, and segregation analyses</h2>
<div class="columns">
<div class="column" style="width:35%;">
<ul>
<li><strong>Aggregation/heritability analyses</strong>: Investigating patterns of phenotypic correlation between relatives</li>
<li><strong>Segregation analysis</strong>: Finding support for a specific genetic model underlying inheritance patterns</li>
</ul>
<div class="fragment callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>These analyses <strong>do not always</strong> use molecular genetic data… so why should we care?</p>
</div>
</div>
</div><div class="column" style="width:65%;">
<p><img src="https://www.cell.com/cms/10.1016/j.cell.2018.04.032/asset/c2ada063-7d56-4685-8c66-3dcb8e71217b/main.assets/fx1_lrg.jpg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="a-gap-in-estimation" class="level2">
<h2 class="anchored" data-anchor-id="a-gap-in-estimation">A gap in estimation</h2>
<div class="columns">
<div class="column" style="width:80%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://journals.plos.org/plosgenetics/article/figure/image?size=large&amp;id=10.1371/journal.pgen.1008222.g001" class="img-fluid figure-img"></p>
<figcaption>Young, A. I. (2019), “Solving the missing heritability problem,” PLOS Genetics, Public Library of Science, 15, e1008222. https://doi.org/10.1371/journal.pgen.1008222.</figcaption>
</figure>
</div>
</div><div class="column" style="width:20%;">
<ul>
<li>Aggregation and heritability analyses tend to have <strong>much higher heritability</strong> estimates of traits than genotyping methods</li>
<li>Understanding these models may help <strong>explain this delta</strong></li>
</ul>
</div>
</div>
</section>
<section id="discussion" class="level2">
<h2 class="anchored" data-anchor-id="discussion">Discussion</h2>
<ol type="1">
<li><p>The author frames the “missing heritability” problem as the discrepancy between estimates from twin studies and those from early GWAS. Based on the text, what is the core assumption of the classical twin study design for estimating heritability? How might a violation of this assumption lead to an overestimation of heritability for certain traits?</p></li>
<li><p>The author argues that methods like RDR and Sib-Regression are more robust against certain biases. What specific confounding factor, prevalent in population-based genomic studies, are these family-based designs better at controlling for?</p></li>
<li><p>If, as the author suggests, the true narrow-sense heritability of a trait like height is closer to the 60-70% estimated by RDR and Sib-Regression than the 80% from twin studies, what are the primary sources of the remaining “gap”? Does this completely solve the missing heritability problem, or does it redefine it?</p></li>
</ol>
</section>
<section id="heritability-first-principles" class="level2">
<h2 class="anchored" data-anchor-id="heritability-first-principles">Heritability, first principles</h2>
<p>Let <span class="math inline">\(Y = G + E\)</span></p>
<ul>
<li>Trait Variance: <span class="math inline">\(\operatorname{Var}(Y)\)</span></li>
<li>Variance due to genes: <span class="math inline">\(\operatorname{Var}(G)\)</span></li>
<li>Variance due to environment: <span class="math inline">\(\operatorname{Var}(E)\)</span>.</li>
</ul>
<p>If we assume independence of <span class="math inline">\(G\)</span> and <span class="math inline">\(E\)</span>, then <span class="math display">\[\operatorname{Var}(Y) = \operatorname{Var}(G) + \operatorname{Var}(E)\]</span></p>
</section>
<section id="heritability-first-principles-1" class="level2">
<h2 class="anchored" data-anchor-id="heritability-first-principles-1">Heritability, first principles</h2>
<p>We can decompose <span class="math inline">\(\operatorname{Var}(G)\)</span> into different genetic effects: - Additive effects: <span class="math inline">\(A\)</span> - Dominance effects: <span class="math inline">\(D\)</span> - Epistatic effects: <span class="math inline">\(I\)</span></p>
<p>So we can write:</p>
<p><span class="math display">\[\operatorname{Var}(Y) = \operatorname{Var}(A) + \operatorname{Var}(D) + \operatorname{Var}(I) + \operatorname{Var}(E)\]</span></p>
<ul>
<li>Broad-sense: <span class="math inline">\(H^2 = \operatorname{Var}(A) + \operatorname{Var}(D) + \operatorname{Var}(I) / \operatorname{Var}(Y)\)</span></li>
<li>Narrow-sense: <span class="math inline">\(h^2 =\operatorname{Var}(A) / \operatorname{Var}(Y)\)</span></li>
<li>Context matters: <span class="math inline">\(h^2\)</span> depends on population, environment, and measurement; it is not a trait constant.</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Familial aggregation <span class="math inline">\(\neq\)</span> heritability. Shared environment and assortment can produce aggregation without genetic causation.</p>
</div>
</div>
</section>
<section id="estimating-h2-from-relatives-marker-free" class="level2">
<h2 class="anchored" data-anchor-id="estimating-h2-from-relatives-marker-free">Estimating <span class="math inline">\(h^2\)</span> from relatives (marker-free)</h2>
<section id="parent-offspring-regression" class="level3">
<h3 class="anchored" data-anchor-id="parent-offspring-regression">Parent-offspring regression</h3>
<p><span class="math display">\[
Y_{\text{offspring}} = \alpha + \beta \cdot Y_{\text{mid-parent}} + \varepsilon
\]</span></p>
<ul>
<li><p>By definition, <span class="math inline">\(\beta = \frac{\operatorname{Cov}(Y_{\text{offspring}}, Y_{\text{mid-parent}})}{\operatorname{Var}(Y_{\text{mid-parent}})}\)</span>.</p></li>
<li><p>Given that an offspring inherits half its genes from each parent, <span class="math inline">\(\operatorname{Cov}(Y_{\text{offspring}}, Y_{\text{mid-parent}}) = \frac{1}{2}\operatorname{Var}(A)\)</span></p></li>
</ul>
</section>
</section>
<section id="estimating-h2-from-relatives-marker-free-1" class="level2">
<h2 class="anchored" data-anchor-id="estimating-h2-from-relatives-marker-free-1">Estimating <span class="math inline">\(h^2\)</span> from relatives (marker-free)</h2>
<section id="parent-offspring-regression-1" class="level3">
<h3 class="anchored" data-anchor-id="parent-offspring-regression-1">Parent-offspring regression</h3>
<p><span class="math display">\[\begin{align*}
\operatorname{Var}(Y_{\text{mid-parent}})
&amp;= \operatorname{Var}\left(\frac{Y_{\text{parent1}} + Y_{\text{parent2}}}{2}\right) \\
&amp;= \frac{1}{4}\left(\operatorname{Var}(Y) + \operatorname{Var}(Y)\right) \\
&amp;= \frac{1}{2}\operatorname{Var}(Y)
\end{align*}\]</span></p>
<p>Plugging this back into the expression for <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display">\[\beta = \frac{\frac{1}{2}\operatorname{Var}(A)}{\frac{1}{2}\operatorname{Var}(Y)} = \frac{\operatorname{Var}(A)}{\operatorname{Var}(Y)} = h^2\]</span></p>
</section>
</section>
<section id="estimating-h2-from-relatives-marker-free-2" class="level2">
<h2 class="anchored" data-anchor-id="estimating-h2-from-relatives-marker-free-2">Estimating <span class="math inline">\(h^2\)</span> from relatives (marker-free)</h2>
<section id="twin-studies" class="level3">
<h3 class="anchored" data-anchor-id="twin-studies">Twin Studies</h3>
<ul>
<li>Assume equal environments for MZ and DZ twins, and a simplified model</li>
<li><span class="math inline">\(\operatorname{Var}(Y) = \operatorname{Var}(A) + \operatorname{Var}(E)\)</span></li>
<li><span class="math inline">\(h^2 = 2(r_{\text{MZ}} - r_{\text{DZ}})\)</span></li>
</ul>
<p>where <span class="math inline">\(r_{\text{MZ}}\)</span> and <span class="math inline">\(r_{\text{DZ}}\)</span> are the correlations between monozygotic and dizygotic twins, respectively.</p>
</section>
</section>
<section id="pedigree-variance-components-continuous-traits" class="level2">
<h2 class="anchored" data-anchor-id="pedigree-variance-components-continuous-traits">Pedigree variance components (continuous traits)</h2>
<p>Model: <span class="math display">\[
\mathbf{Y} = \mathbf{X}\boldsymbol{\beta} + \mathbf{Z}\mathbf{u} + \boldsymbol{\varepsilon},\quad
\mathbf{u} \sim \mathcal{N}(\mathbf{0}, \mathbf{A}\sigma_A^2),\quad
\boldsymbol{\varepsilon} \sim \mathcal{N}(\mathbf{0}, \mathbf{I}\sigma_E^2),
\]</span></p>
<p>where <span class="math inline">\(\mathbf{A}\)</span> is the pedigree additive relationship matrix with <span class="math inline">\(A_{ij}=2\phi_{ij}\)</span>.</p>
<ul>
<li>Heritability: <span class="math inline">\(h^2 = \sigma_A^2 / (\sigma_A^2 + \sigma_E^2)\)</span>.</li>
<li>REML estimates <span class="math inline">\((\sigma_A^2,\sigma_E^2)\)</span> efficiently; classical family estimators are special cases under balanced designs.</li>
<li>ACE (twin) view: <span class="math inline">\(\operatorname{Cov}(\text{MZ}) = A + C\)</span>, <span class="math inline">\(\operatorname{Cov}(\text{DZ}) = \tfrac{1}{2}A + C\)</span>; <span class="math inline">\(h^2 = \operatorname{Var}(A)/\operatorname{Var}(Y)\)</span>, etc.</li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Boundary testing: testing <span class="math inline">\(\sigma_A^2=0\)</span> is on the boundary. The LRT null is the mixture <span class="math inline">\(\tfrac{1}{2}\chi_0^2 + \tfrac{1}{2}\chi_1^2\)</span> (or use an RLRT).</p>
</div>
</div>
</section>
<section id="binary-traits-via-the-liability-threshold-model" class="level2">
<h2 class="anchored" data-anchor-id="binary-traits-via-the-liability-threshold-model">Binary traits via the liability-threshold model</h2>
<p>Idea: a binary phenotype arises when a continuous liability <span class="math inline">\(\ell\)</span> crosses a threshold <span class="math inline">\(T\)</span>.</p>
<p><span class="math display">\[
Y = \begin{cases}
1 &amp; \text{if } \ell &gt; T,\
0 &amp; \text{if } \ell \le T,
\end{cases}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\ell = G + E,\quad G \sim \mathcal{N}(0,\sigma_G^2),\ E \sim \mathcal{N}(0,\sigma_E^2)\)</span></p></li>
<li><p>Population prevalence: <span class="math inline">\(K = \Pr(\ell &gt; T) = 1 - \Phi(T)\)</span> with <span class="math inline">\(T = \Phi^{-1}(1-K)\)</span>.</p></li>
<li><p>Liability-scale heritability: <span class="math inline">\(h_\ell^2 = \sigma_G^2 / (\sigma_G^2 + \sigma_E^2)\)</span>.</p></li>
</ul>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Assumptions: normal liability, single threshold, no <span class="math inline">\(G\times E\)</span> on the liability scale, correct <span class="math inline">\(K\)</span>.</p>
</div>
</div>
</section>
<section id="probit-view-and-logistic-note" class="level2">
<h2 class="anchored" data-anchor-id="probit-view-and-logistic-note">Probit view and logistic note</h2>
<ul>
<li>Probit GLM/GLMM corresponds to a normal-liability threshold model; adding pedigree random effects on the probit scale estimates liability-scale variance components.</li>
</ul>
</section>
<section id="observed-vs.-liability-scale-h2" class="level2">
<h2 class="anchored" data-anchor-id="observed-vs.-liability-scale-h2">Observed vs.&nbsp;liability-scale <span class="math inline">\(h^2\)</span></h2>
<p>For an unascertained sample with sample prevalence <span class="math inline">\(P=K\)</span>, <span class="math display">\[
h_{\text{obs}}^2 ;\approx; h_\ell^2 \cdot \frac{\phi(T)^2}{K(1-K)},\qquad T=\Phi^{-1}(1-K).
\]</span></p>
<p>For case–control sampling with sample prevalence <span class="math inline">\(P \ne K\)</span>, <span class="math display">\[
h_\ell^2 ;\approx; h_{\text{obs}}^2 \cdot \frac{K^2(1-K)^2}{\phi(T)^2\, P(1-P)}.
\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Low-prevalence traits (<span class="math inline">\(K \ll 0.5\)</span>) often have <span class="math inline">\(h_{\text{obs}}^2 \ll h_\ell^2\)</span>. Always report the scale, <span class="math inline">\(K\)</span>, and (if applicable) <span class="math inline">\(P\)</span>.</p>
</div>
</div>
</section>
<section id="ascertainment-as-conditioning-truncation-view" class="level2">
<h2 class="anchored" data-anchor-id="ascertainment-as-conditioning-truncation-view">Ascertainment as conditioning (truncation view)</h2>
<p>If we only observe <span class="math inline">\(Y\)</span> under an event <span class="math inline">\(A\)</span> (e.g., <span class="math inline">\(Y\)</span> recorded only when <span class="math inline">\(Y&gt;T\)</span> or when a proband is affected), the correct likelihood uses the conditional density <span class="math display">\[
p(y \mid A, \theta) ;=; \frac{p(y \mid \theta),\mathbf{1}{y \in A}}{\Pr(A \mid \theta)}.
\]</span></p>
<ul>
<li>Ignoring ascertainment biases parameters (e.g., means, prevalences, and regression slopes).</li>
<li>The liability-threshold model and segregation analysis both require conditioning on how families were recruited.</li>
</ul>
</section>
<section id="segregation-analysis-no-markers" class="level2">
<h2 class="anchored" data-anchor-id="segregation-analysis-no-markers">Segregation analysis (no markers)</h2>
<p>Goal: compare inheritance models (major gene vs polygenic vs mixed) using family phenotypes.</p>
<ul>
<li>Likelihood: specify penetrance by genotype <span class="math inline">\(\Rightarrow\)</span> build family likelihood; condition on ascertainment (e.g., proband affected).</li>
<li>Dominant example (<span class="math inline">\(Dd \times dd\)</span>): if <span class="math inline">\(p_D\)</span> is the offspring affected probability, then with <span class="math inline">\(n\)</span> children and <span class="math inline">\(n_A\)</span> affected,</li>
<li><span class="math inline">\(N_A \sim \operatorname{Binom}(n, p_D)\)</span></li>
<li><span class="math inline">\(\log L(p_D \mid n_A,n) = n_A \log p_D + (n-n_A)\log(1-p_D)\)</span></li>
<li>Recessive note (<span class="math inline">\(Dd \times Dd\)</span>): unaffected genotypes are ambiguous unless carriers are observed (harder identifiability).</li>
<li>Pitfalls: reduced penetrance, phenocopies, ascertainment, HWE assumptions.</li>
</ul>
</section>
<section id="summary-key-takeaways" class="level2">
<h2 class="anchored" data-anchor-id="summary-key-takeaways">Summary &amp; key takeaways</h2>
<ul>
<li>Heritability: <span class="math inline">\(H^2\)</span> vs <span class="math inline">\(h^2\)</span>; interpretation is population- and environment-specific.</li>
<li>Variance components (pedigrees): LMM with <span class="math inline">\(A\)</span>-matrix unifies family estimators; handle boundary tests correctly.</li>
<li>Binary traits: liability-threshold,</li>
<li>Segregation: fit penetrance-based likelihoods; condition on ascertainment.</li>
<li>Method habit: when unsure, simulate to check intuition and bias under ascertainment.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>