<!DOCTYPE html>
<html lang="en"><head>
<link href="../course_logo.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-c8ad9e5dbd60b7b70b38521ab19b7da4.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.34">

  <title>Statistical Genetics – Lecture 03: Advanced Likelihood Methods and Inference</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-92b42eaa45933db571ed77ca2219fc17.css">
  <link rel="stylesheet" href="styles.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Lecture 03: Advanced Likelihood Methods and Inference</h1>
  <p class="subtitle">PUBH 8878, Statistical Genetics</p>

<div class="quarto-title-authors">
</div>

</section>
<section id="review-likelihood-function-basics" class="slide level2">
<h2>Review: Likelihood Function Basics</h2>
<p>From Lecture 1, we learned:</p>
<ul>
<li>Likelihood function: <span class="math inline">\(L(\boldsymbol{\theta} | \text{data}) = P(\text{data} | \boldsymbol{\theta})\)</span></li>
<li>Maximum Likelihood Estimation (MLE)</li>
<li>Simple one-parameter examples</li>
</ul>
<p>However often direct MLE is not possible because</p>
<ul>
<li>Closed-form solution does not exist</li>
<li>Missing or latent data</li>
<li>High-dimensional or constrained parameter space leads to non-convex surface with multiple local maxima</li>
</ul>
</section>
<section id="agenda" class="slide level2">
<h2>Agenda</h2>
<ul>
<li>Optimization for MLE: Newton–Raphson, Gradient Descent, SGD</li>
<li>EM algorithm: gene frequencies and incomplete data</li>
<li>Linkage analysis: two-point, unknown phase EM, multipoint HMM</li>
<li>Linkage disequilibrium (LD) and its measures (D, D’, r)</li>
<li>Association: single-marker/haplotype tests and basic QC</li>
</ul>
</section>
<section id="newton-raphson-method-for-mle" class="slide level2">
<h2>Newton-Raphson Method for MLE</h2>
<ul>
<li>General procedure to find <span class="math inline">\(x\)</span> such that <span class="math inline">\(g(x) = 0\)</span></li>
<li>Uses Taylor Expansion, for <span class="math inline">\(g(x)\)</span> about a point <span class="math inline">\(x = a\)</span>:</li>
</ul>
<p><span class="math display">\[\begin{align*}
g(x) = g(a) &amp;+
\frac{g'(a)(x-a)}{1!} + \frac{g''(a)(x-a)^2}{2!} \\
&amp;+ ... + \frac{g^{(n)}(a)(x-a)^n}{n!}
\end{align*}\]</span></p>
</section>
<section id="taylor-series-convergence" class="slide level2">
<h2>Taylor Series Convergence</h2>

<img data-src="lecture-03_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section>
<section id="gradient-descent" class="slide level2">
<h2>Gradient Descent</h2>
<ul>
<li>First-order iterative optimization algorithm</li>
<li>Does not rely on matrix inversions <span class="math inline">\(\longrightarrow\)</span> better for high dimensional problems</li>
<li><a href="https://uclaacm.github.io/gradient-descent-visualiser/#playground">Visualizer from UCLA</a></li>
</ul>
</section>
<section id="stochastic-gradient-descent-sgd" class="slide level2">
<h2>Stochastic Gradient Descent (SGD)</h2>
<ul>
<li>Uses mini-batches or single observations to form an unbiased gradient estimate.</li>
<li>Pros: scales to large datasets; inexpensive per-iteration; escapes shallow local structure via noise.</li>
<li>Cons: requires step-size schedule (e.g., Robbins–Monro); more variance in updates than full GD.</li>
<li>Practical tweaks: momentum/Nesterov, Adam/Adagrad; early stopping and learning-rate decay.</li>
</ul>
</section>
<section id="the-em-algorithm" class="slide level2">
<h2>The EM Algorithm</h2>
<ul>
<li>Expectation-Maximization Algorithm</li>
<li>Key idea: transform an <strong>incomplete</strong> data problem into a <strong>complete</strong> data problem</li>
</ul>
<p><span class="math display">\[
p\left(y \mid \theta \right) = \frac{p\left(y, z \mid \theta \right)}{p\left(z \mid y, \theta\right)}
\]</span></p>
</section>
<section id="em-for-gene-frequencies" class="slide level2">
<h2>EM for Gene Frequencies</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Genotype</th>
<th style="text-align: left;">Phenotype</th>
<th style="text-align: left;">Observed Counts</th>
<th style="text-align: left;">Genotype Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(AA\)</span></td>
<td style="text-align: left;"><span class="math inline">\(A\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_A\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p_A^2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(AO\)</span></td>
<td style="text-align: left;"><span class="math inline">\(A\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(2 p_A p_O\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(AB\)</span></td>
<td style="text-align: left;"><span class="math inline">\(AB\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_{AB}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(2 p_A p_B\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(BB\)</span></td>
<td style="text-align: left;"><span class="math inline">\(B\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_B\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p_B^2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(BO\)</span></td>
<td style="text-align: left;"><span class="math inline">\(B\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(2 p_B p_O\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(OO\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_O\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p_O^2\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="em-for-gene-frequencies-1" class="slide level2">
<h2>EM for Gene Frequencies</h2>
<ul>
<li>We don’t know if <span class="math inline">\(n_A\)</span> is from <span class="math inline">\(AA\)</span> or <span class="math inline">\(AO\)</span>! (And similarly for <span class="math inline">\(n_B\)</span>)</li>
<li>However, given our data model, we can find values of <span class="math inline">\((\hat{p}_A, \hat{p}_B)\)</span> via EM</li>
</ul>
</section>
<section id="em-for-gene-frequencies-2" class="slide level2">
<h2>EM for Gene Frequencies</h2>
<ul>
<li><p>Start with initial <span class="math inline">\((p_A^{(0)}, p_B^{(0)})\)</span> and set <span class="math inline">\(p_O^{(0)} = 1 - p_A^{(0)} - p_B^{(0)}\)</span>.</p></li>
<li><p>E-step: allocate ambiguous phenotype counts:</p>
<ul>
<li><span class="math inline">\(A\)</span> phenotype: <span class="math inline">\(\tilde n_{AA} = n_A \frac{(p_A^{(t)})^2}{(p_A^{(t)})^2 + 2 p_A^{(t)} p_O^{(t)}}\)</span>, <span class="math inline">\(\tilde n_{AO} = n_A \frac{2 p_A^{(t)} p_O^{(t)}}{(p_A^{(t)})^2 + 2 p_A^{(t)} p_O^{(t)}}\)</span>.</li>
<li><span class="math inline">\(B\)</span> phenotype: <span class="math inline">\(\tilde n_{BB} = n_B \frac{(p_B^{(t)})^2}{(p_B^{(t)})^2 + 2 p_B^{(t)} p_O^{(t)}}\)</span>, <span class="math inline">\(\tilde n_{BO} = n_B \frac{2 p_B^{(t)} p_O^{(t)}}{(p_B^{(t)})^2 + 2 p_B^{(t)} p_O^{(t)}}\)</span>.</li>
</ul></li>
</ul>
</section>
<section id="em-for-gene-frequencies-3" class="slide level2">
<h2>EM for Gene Frequencies</h2>
<ul>
<li>M-step (with <span class="math inline">\(N\)</span> total individuals):</li>
</ul>
<span class="math display">\[\begin{aligned}
p_A^{(t+1)} &amp;= \frac{2\tilde n_{AA} + \tilde n_{AO} + n_{AB}}{2N},\\
p_B^{(t+1)} &amp;= \frac{2\tilde n_{BB} + \tilde n_{BO} + n_{AB}}{2N},\\
p_O^{(t+1)} &amp;= 1 - p_A^{(t+1)} - p_B^{(t+1)}
\end{aligned}\]</span>
<ul>
<li>Iterate until parameter changes are below a tolerance.</li>
</ul>
</section>
<section id="em-for-gene-frequencies-4" class="slide level2">
<h2>EM for Gene Frequencies</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Genotype</th>
<th style="text-align: left;">Phenotype</th>
<th style="text-align: left;">Observed Counts</th>
<th style="text-align: left;">Genotype Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(AA\)</span></td>
<td style="text-align: left;"><span class="math inline">\(A\)</span></td>
<td style="text-align: left;"><span class="math inline">\(725\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p_A^2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(AO\)</span></td>
<td style="text-align: left;"><span class="math inline">\(A\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(2 p_A p_O\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(AB\)</span></td>
<td style="text-align: left;"><span class="math inline">\(AB\)</span></td>
<td style="text-align: left;"><span class="math inline">\(72\)</span></td>
<td style="text-align: left;"><span class="math inline">\(2 p_A p_B\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(BB\)</span></td>
<td style="text-align: left;"><span class="math inline">\(B\)</span></td>
<td style="text-align: left;"><span class="math inline">\(258\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p_B^2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(BO\)</span></td>
<td style="text-align: left;"><span class="math inline">\(B\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(2 p_B p_O\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(OO\)</span></td>
<td style="text-align: left;"><span class="math inline">\(O\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1073\)</span></td>
<td style="text-align: left;"><span class="math inline">\(p_O^2\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="em-starting-values-matter" class="slide level2">
<h2>EM: Starting Values Matter</h2>
<ul>
<li>Different initial <span class="math inline">\((p_A, p_B, p_O)\)</span> can change speed (not the final MLE)</li>
<li>Strategies:
<ul>
<li>Equal: <span class="math inline">\((1/3, 1/3, 1/3)\)</span></li>
<li>Unbalanced guess: <span class="math inline">\((0.01, 0.98, 0.01)\)</span></li>
<li>Smart (use <span class="math inline">\(p_O^{(0)} = \sqrt{n_O/N}\)</span>, solve for <span class="math inline">\((p_A^{(0)}, p_B^{(0)})\)</span> from <span class="math inline">\(2p_A p_B\)</span>)</li>
</ul></li>
<li>Tolerance of <span class="math inline">\(1 \times 10^{-6}\)</span></li>
</ul>
</section>
<section id="em-starting-values-matter-1" class="slide level2">
<h2>EM: Starting Values Matter</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Strategy</th>
<th style="text-align: right;">Iterations</th>
<th style="text-align: right;"><span class="math inline">\(\hat{p}_A\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\hat{p}_B\)</span></th>
<th style="text-align: right;"><span class="math inline">\(\hat{p}_O\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Equal</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.209131</td>
<td style="text-align: right;">0.080801</td>
<td style="text-align: right;">0.710068</td>
</tr>
<tr class="even">
<td style="text-align: left;">Smart</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.209131</td>
<td style="text-align: right;">0.080801</td>
<td style="text-align: right;">0.710068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Unbalanced</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.209131</td>
<td style="text-align: right;">0.080801</td>
<td style="text-align: right;">0.710068</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="em-convergence-log-likelihood-gap" class="slide level2">
<h2>EM Convergence: Log-Likelihood Gap</h2>

<img data-src="lecture-03_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="em-parameter-trajectories" class="slide level2">
<h2>EM Parameter Trajectories</h2>

<img data-src="lecture-03_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section>
<section id="when-does-em-fail" class="slide level2">
<h2>When does EM fail?</h2>
<ul>
<li><strong>Non-identifiability / flat likelihood</strong>: Ridges in segregation or linkage models; EM wanders or stalls.</li>
<li><strong>Local maxima &amp; starts</strong>: Multiple modes (e.g., mixture of penetrance classes); poor initialization traps EM.</li>
<li><strong>Boundary degeneracy</strong>: Rare allele/component weight driven to 0; variance or frequency estimates collapse.</li>
<li><strong>Model misspecification</strong>: Violated assumptions (e.g., Hardy-Weinberg, stratification) give misleading “convergence.”</li>
</ul>
</section>
<section id="linkage-vs-association-testing" class="slide level2">
<h2>Linkage vs Association Testing</h2>
<ul>
<li>Linkage: Tracks co-segregation of markers and traits within families to map disease genes.
<ul>
<li>Null hypothesis: no linkage (independent assortment), <span class="math inline">\(\theta = 0.5\)</span>.</li>
</ul></li>
<li>Association: Tests for correlation between variants and traits in populations to pinpoint causal loci.
<ul>
<li>Null hypothesis: no association (e.g., <span class="math inline">\(\beta=0\)</span> or OR=1).</li>
</ul></li>
</ul>
</section>
<section id="two-point-linkage-terms" class="slide level2">
<h2>Two-Point Linkage: Terms</h2>
<ul>
<li>Independent assortment (recall): when loci are unlinked, transmissions are independent and the chance a crossover separates them is <span class="math inline">\(\theta=0.5\)</span> (Mendel’s Second Law).</li>
<li>Informative transmission/meiosis: a parent→child transmission where the transmitting parent is heterozygous at the loci of interest and the genotypes allow us to tell whether a crossover occurred.</li>
<li>Nonrecombinant transmission: the child receives an allele combination that matches one of the transmitting parent’s original allele pairs (no crossover between the loci).</li>
<li>Recombinant transmission: the child receives a new combination relative to the transmitting parent’s original pair (a crossover occurred between the loci).</li>
</ul>
</section>
<section id="two-point-linkage-direct-counting" class="slide level2">
<h2>Two-Point Linkage: Direct Counting</h2>
<ul>
<li>Count <span class="math inline">\(R\)</span> recombinants and <span class="math inline">\(NR\)</span> nonrecombinants; total informative <span class="math inline">\(I=R+NR\)</span>.</li>
<li>Point estimate: <span class="math inline">\(\hat{\theta}=R/I\)</span>.</li>
<li>LOD from counts (vs.&nbsp;independence at <span class="math inline">\(\theta=0.5\)</span>): <span class="math display">\[
\mathrm{LOD}(\theta) = \log_{10}\!\left\{ \frac{\theta^{R} (1-\theta)^{NR}}{0.5^{I}} \right\}
\]</span></li>
</ul>
</section>
<section id="worked-example-direct-counting-lod" class="slide level2">
<h2>Worked Example: Direct Counting LOD</h2>
<ul>
<li>Suppose <span class="math inline">\(I=40\)</span> informative meioses with <span class="math inline">\(R=12\)</span> recombinants. For <span class="math inline">\(\theta=0.1\)</span>, <span class="math display">\[
  \mathrm{LOD}(0.1) = \log_{10}\!\left\{ \frac{0.1^{12} \cdot 0.9^{28}}{0.5^{40}} \right\}.
  \]</span></li>
<li>Maximize <span class="math inline">\(\mathrm{LOD}(\theta)\)</span> over <span class="math inline">\(\theta\)</span> to estimate the recombination fraction; thresholds like LOD <span class="math inline">\(\ge 3\)</span> (strong evidence) and <span class="math inline">\(\le -2\)</span> (against) guide interpretation.</li>
</ul>
</section>
<section id="two-point-linkage-em-with-unknown-phase" class="slide level2">
<h2>Two-Point Linkage: EM with Unknown Phase</h2>
<ul>
<li>Setup: One heterozygous transmitting parent at two loci (<span class="math inline">\(A/a\)</span> and <span class="math inline">\(B/b\)</span>), crossed to an <span class="math inline">\(aabb\)</span> mate; <span class="math inline">\(N\)</span> children observed. The parent’s haplotype configuration (coupling <span class="math inline">\(AB/ab\)</span> vs repulsion <span class="math inline">\(Ab/aB\)</span>) is unknown.</li>
<li>Observations: child haplotype counts (which equal transmitted haplotypes from the heterozygous parent): <span class="math inline">\((n_{AB}, n_{Ab}, n_{aB}, n_{ab})\)</span> with <span class="math inline">\(N=\sum n_{\cdot}\)</span>. Let <span class="math inline">\(n_{\text{NR}} = n_{AB}+n_{ab}\)</span> and <span class="math inline">\(n_{\text{R}} = n_{Ab}+n_{aB}\)</span>.</li>
</ul>
</section>
<section id="two-point-linkage-em-with-unknown-phase-1" class="slide level2">
<h2>Two-Point Linkage: EM with Unknown Phase</h2>
<ul>
<li>Model (given recombination fraction <span class="math inline">\(\theta\)</span>):
<ul>
<li>If phase is coupling (<span class="math inline">\(Z=C\)</span>): <span class="math inline">\(P(\text{NR})=1-\theta\)</span>, <span class="math inline">\(P(\text{R})=\theta\)</span> (split equally across the two categories).</li>
<li>If phase is repulsion (<span class="math inline">\(Z=R\)</span>): <span class="math inline">\(P(\text{NR})=\theta\)</span>, <span class="math inline">\(P(\text{R})=1-\theta\)</span>.</li>
</ul></li>
<li>Latent variable: <span class="math inline">\(Z\in\{C,R\}\)</span> (parental phase). Prior <span class="math inline">\(P(Z=C)=P(Z=R)=1/2\)</span>.</li>
</ul>
</section>
<section id="two-point-linkage-em-with-unknown-phase-2" class="slide level2">
<h2>Two-Point Linkage: EM with Unknown Phase</h2>
<p>E-step (posterior phase weights)</p>
<p><span class="math display">\[
w_C \equiv P(Z{=}C\mid \text{data},\theta^{(t)}) \propto \tfrac12\,(1-\theta^{(t)})^{n_{\text{NR}}}\,(\theta^{(t)})^{n_{\text{R}}}
\]</span></p>
<p><span class="math display">\[
w_R = 1 - w_C \propto \tfrac12\,(\theta^{(t)})^{n_{\text{NR}}}\,(1-\theta^{(t)})^{n_{\text{R}}}.
\]</span></p>
<p>M-step (update <span class="math inline">\(\theta\)</span>)</p>
<p><span class="math display">\[\begin{align*}
\theta^{(t+1)}
&amp;= \frac{\mathbb E[\text{\# recombinants}\mid\text{data},\theta^{(t)}]}{N} \\
&amp;= \frac{w_C\,n_{\text{R}} + w_R\,n_{\text{NR}}}{N}
\end{align*}\]</span></p>
</section>
<section id="numerical-illustration" class="slide level2">
<h2>Numerical illustration</h2>
<ul>
<li><p>Let <span class="math inline">\((n_{AB}, n_{Ab}, n_{aB}, n_{ab})=(18,5,4,17)\)</span> so <span class="math inline">\(N=44\)</span>, <span class="math inline">\(n_{\text{NR}}=35\)</span>, <span class="math inline">\(n_{\text{R}}=9\)</span>.</p></li>
<li><p>True <span class="math inline">\(\theta=(5+4)/44=0.2045\)</span>.</p></li>
<li><p>Let’s begin with an estimate <span class="math inline">\(\theta^{(0)}=0.99\)</span> and iterate 5 times.</p></li>
</ul>
</section>
<section id="numerical-illustration-1" class="slide level2">
<h2>Numerical illustration</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>n_AB <span class="ot">&lt;-</span> <span class="dv">18</span></span>
<span id="cb1-2"><a></a>n_Ab <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb1-3"><a></a>n_aB <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1-4"><a></a>n_ab <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb1-5"><a></a>theta_true <span class="ot">&lt;-</span> (n_Ab <span class="sc">+</span> n_aB) <span class="sc">/</span> (n_AB <span class="sc">+</span> n_Ab <span class="sc">+</span> n_aB <span class="sc">+</span> n_ab)</span>
<span id="cb1-6"><a></a>n_NR <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb1-7"><a></a>n_R <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb1-8"><a></a>N <span class="ot">&lt;-</span> n_NR <span class="sc">+</span> n_R</span>
<span id="cb1-9"><a></a>theta_init <span class="ot">&lt;-</span> <span class="fl">0.00001</span></span>
<span id="cb1-10"><a></a>iter <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">iter =</span> <span class="dv">0</span>, <span class="at">theta =</span> theta_init, <span class="at">theta_true =</span> theta_true, <span class="at">abs_err =</span> theta_init <span class="sc">-</span> theta_true)</span>
<span id="cb1-11"><a></a>theta <span class="ot">&lt;-</span> theta_init</span>
<span id="cb1-12"><a></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) {</span>
<span id="cb1-13"><a></a>    numC <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span>n_NR <span class="sc">*</span> (theta)<span class="sc">^</span>n_R</span>
<span id="cb1-14"><a></a>    numR <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> (theta)<span class="sc">^</span>n_NR <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> theta)<span class="sc">^</span>n_R</span>
<span id="cb1-15"><a></a>    wC <span class="ot">&lt;-</span> numC <span class="sc">/</span> (numC <span class="sc">+</span> numR)</span>
<span id="cb1-16"><a></a>    wR <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> wC</span>
<span id="cb1-17"><a></a>    theta <span class="ot">&lt;-</span> (wC <span class="sc">*</span> n_R <span class="sc">+</span> wR <span class="sc">*</span> n_NR) <span class="sc">/</span> N</span>
<span id="cb1-18"><a></a>    iter <span class="ot">&lt;-</span> <span class="fu">rbind</span>(iter, <span class="fu">data.frame</span>(<span class="at">iter =</span> t, <span class="at">theta =</span> theta, <span class="at">theta_true =</span> theta_true, <span class="at">abs_err =</span> theta <span class="sc">-</span> theta_true))</span>
<span id="cb1-19"><a></a>}</span>
<span id="cb1-20"><a></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb1-21"><a></a>    <span class="fu">tail</span>(iter, <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">Final Theta</span><span class="st">`</span> <span class="ot">=</span> theta, <span class="st">`</span><span class="at">True Theta</span><span class="st">`</span> <span class="ot">=</span> theta_true),</span>
<span id="cb1-22"><a></a>    <span class="at">digits =</span> <span class="dv">4</span></span>
<span id="cb1-23"><a></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">Final Theta</th>
<th style="text-align: right;">True Theta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">21</td>
<td style="text-align: right;">0.2045</td>
<td style="text-align: right;">0.2045</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="from-two-point-em-to-multipoint" class="slide level2">
<h2>From Two-Point EM to Multipoint</h2>
<ul>
<li>Same objective: estimate recombination while marginalizing over latent transmissions/phase under current <span class="math inline">\(\theta\)</span>.</li>
<li>E-step engine: compute required posteriors via Elston–Stewart peeling (pedigrees) or Lander–Green forward–backward (marker HMM) when you have multiple markers and missing genotypes.</li>
<li>Quantities needed: <span class="math inline">\(\mathbb E[\#\,\text{recombinants between adjacent markers}]\)</span> and <span class="math inline">\(\mathbb E[\#\,\text{informative transmissions}]\)</span> under current map.</li>
<li>Use in practice: either (a) plug these expectations into an EM-style update, or (b) more commonly, scan positions to build a LOD curve and report peak and 1-LOD interval.</li>
</ul>
</section>
<section id="what-is-multipoint" class="slide level2">
<h2>What Is Multipoint?</h2>
<ul>
<li>Definition: jointly analyze many linked markers (not just a pair) to infer inheritance patterns across a chromosome region while estimating recombination parameters.</li>
<li>Why it helps: each marker contributes information; combining them increases the number of informative transmissions and sharpens localization (higher, narrower LOD peaks).</li>
<li>Model view: a sequence of inheritance states (who inherited which parental haplotypes) connected by transitions governed by recombination rates — naturally represented as an HMM.</li>
<li>Practical outputs: likelihood/LOD as a function of position, posterior IBD/phase probabilities, and expected recombinant counts between adjacent markers.</li>
<li>Algorithms: Elston–Stewart (peeling) is efficient for large, shallow pedigrees; Lander–Green (HMM) is efficient for many markers on small/moderate pedigrees.</li>
</ul>
</section>
<section id="multipoint-linkage-hmm" class="slide level2">
<h2>Multipoint Linkage (HMM)</h2>

<img data-src="lecture-03_files/figure-revealjs/unnamed-chunk-9-1.png" width="864" class="r-stretch"></section>
<section id="multipoint-linkage-hmm-1" class="slide level2">
<h2>Multipoint Linkage (HMM)</h2>
<ul>
<li>Markers along a chromosome define an HMM over inheritance states; adjacent recombination rates drive transitions.</li>
<li>Combine penetrance with the marker HMM to compute <span class="math inline">\(L(\theta)\)</span> efficiently as you slide along the map (forward–backward yields the needed posteriors even with missing phase/genotypes).</li>
<li>Pros: more information than two-point; better localization. Cons: requires a genetic map and error modeling.</li>
</ul>
</section>
<section id="missing-data-em-in-linkage" class="slide level2">
<h2>Missing-Data EM in Linkage</h2>
<ul>
<li>Complete data: informative meioses labeled as recombinant/nonrecombinant; incomplete data: untyped genotypes/phase.</li>
<li>E-step: compute <span class="math inline">\(E[\text{\# recombinants}]\)</span> and <span class="math inline">\(\mathrm E[\text{\# informative meioses}]\)</span> given current <span class="math inline">\(\theta^{(t)}\)</span> via peeling/HMM.</li>
<li>M-step: <span class="math inline">\(\displaystyle \theta^{(t+1)} = \frac{\mathrm E[R\mid\text{data},\theta^{(t)}]}{\mathrm E[I\mid\text{data},\theta^{(t)}]}\)</span>.</li>
<li>Iterate across <span class="math inline">\(\theta\)</span> grid to produce a LOD curve; maximize or report support interval.</li>
</ul>
</section>
<section id="practical-issues-in-linkage" class="slide level2">
<h2>Practical Issues in Linkage</h2>
<ul>
<li>Model specification: penetrance, phenocopy, allele frequencies; misspecification can distort LOD.</li>
<li>Marker selection: highly polymorphic markers increase information; account for sex-specific recombination if needed.</li>
<li>Computational trade-offs: many markers×large pedigrees require approximations or pruning; consider parametric vs nonparametric linkage.</li>
</ul>
</section>
<section id="linkage-disequilibrium" class="slide level2">
<h2>Linkage Disequilibrium</h2>
<ul>
<li>Let alleles at two markers be denoted <span class="math inline">\(A, a\)</span> and <span class="math inline">\(B, b\)</span></li>
<li>Define allele frequencies by <span class="math inline">\(P_A, P_a, P_B, P_b\)</span></li>
<li>Define frequencies of haplotypes as <span class="math inline">\(P_{AB}, P_{Ab}, P_{aB}, P_{ab}\)</span></li>
<li>Define linkage equilibrium as independence in the <span class="math inline">\(2 \times 2\)</span> table
<ul>
<li>For example, <span class="math inline">\(P_{AB} = P_A \times P_B\)</span></li>
</ul></li>
</ul>
</section>
<section id="linkage-disequilibrium-1" class="slide level2">
<h2>Linkage Disequilibrium</h2>
<ul>
<li>Define the LD coefficient as <span class="math inline">\(D\)</span></li>
</ul>
<p><span class="math display">\[D = p_{AB} - p_A p_B\]</span></p>
<ul>
<li>What are we looking at here?</li>
</ul>
</section>
<section id="linkage-disequilibrium-2" class="slide level2">
<h2>Linkage Disequilibrium</h2>
<ul>
<li>Define the LD coefficient as <span class="math inline">\(D\)</span></li>
</ul>
<p><span class="math display">\[D = p_{AB} - p_A p_B\]</span></p>
<ul>
<li>Note that
<ul>
<li><span class="math inline">\(\operatorname{E}[A] = p_A, \operatorname{E}[B] = p_B\)</span></li>
<li><span class="math inline">\(\operatorname{E}[AB] = p_{AB}\)</span></li>
<li><span class="math inline">\(\operatorname{Cov}(A, B) = \operatorname{E}[AB] - \operatorname{E}[A]\operatorname{E}[B]\)</span></li>
</ul></li>
</ul>
</section>
<section id="linkage-disequilibrium-3" class="slide level2">
<h2>Linkage Disequilibrium</h2>
<ul>
<li><span class="math inline">\(D\)</span>, or <span class="math inline">\(\operatorname{Cov}(A, B)\)</span>, is scale-dependent</li>
<li>Normalized measures:
<ul>
<li><span class="math inline">\(D' = D / D_{\max}\)</span>, where <span class="math inline">\(D_{\max} = \min(p_A p_b, p_a p_B)\)</span> if <span class="math inline">\(D &lt; 0\)</span></li>
<li>Pearson correlation:</li>
</ul></li>
</ul>
<p><span class="math display">\[\begin{align}
r
&amp;= \frac{\operatorname{Cov}(A, B)}{\sqrt{\operatorname{Var}(A) \operatorname{Var}(B)}} \\
&amp;= \frac{D}{\sqrt{p_A(1 - p_A) p_B(1 - p_B)}}
\end{align}\]</span></p>
</section>
<section id="from-ld-to-association" class="slide level2">
<h2>From LD to Association</h2>
<ul>
<li>LD (measured by <span class="math inline">\(D\)</span>, <span class="math inline">\(D'\)</span>, <span class="math inline">\(r\)</span>) captures non-random allele co-occurrence across loci.</li>
<li>Association tests correlate variants (or dosages) with traits in populations.</li>
<li>Bridge: markers tag causal variants via LD; detectable effects attenuate with lower <span class="math inline">\(r^2\)</span>.</li>
</ul>
</section>
<section id="ld-to-association-mini-derivation" class="slide level2">
<h2>LD <span class="math inline">\(\to\)</span> Association: Mini Derivation</h2>
<ul>
<li>Standardize marker <span class="math inline">\(M\)</span> and causal <span class="math inline">\(C\)</span> to unit variance; regress <span class="math inline">\(Y\)</span> on <span class="math inline">\(M\)</span> marginally.</li>
<li><span class="math inline">\(\displaystyle \beta_M = \frac{\operatorname{cov}(M,Y)}{\operatorname{var}(M)} \approx \frac{\operatorname{cov}(M,\beta_C C)}{1} = \beta_C\,\operatorname{cov}(M,C) = r\,\beta_C.\)</span></li>
</ul>
</section>
<section id="ld-to-association-concrete-example" class="slide level2">
<h2>LD <span class="math inline">\(\to\)</span> Association: Concrete Example</h2>
<ul>
<li>Suppose causal per-allele <span class="math inline">\(\mathrm{OR}_C=1.50\)</span> and a tag has <span class="math inline">\(r^2=0.64\)</span> (<span class="math inline">\(r=0.8\)</span>) to the causal.</li>
<li>Attenuation: <span class="math inline">\(\log\mathrm{OR}_M \approx r\,\log\mathrm{OR}_C \Rightarrow \mathrm{OR}_M \approx 1.50^{0.8} \approx 1.38\)</span>.</li>
</ul>
</section>
<section id="single-marker-association-core-tests" class="slide level2">
<h2>Single-Marker Association: Core Tests</h2>
<ul>
<li>Linear trait: <span class="math inline">\(Y=\alpha+\beta G+\gamma^T C+\varepsilon\)</span>; test <span class="math inline">\(H_0{:}\,\beta=0\)</span>.</li>
<li>Logistic (case–control): <span class="math inline">\(\text{logit}\,P(Y=1)=\alpha+\beta G+\gamma^T C\)</span>; <span class="math inline">\(\exp(\beta)\)</span> is OR per allele.</li>
<li>Encodings: additive (0/1/2) or genotypic (AA/Aa/aa); include dominance to test non-additivity.</li>
<li>Armitage trend/allelic or genotypic <span class="math inline">\(\chi^2\)</span> approximate additive logistic.</li>
</ul>
</section>
<section id="single-marker-special-cases" class="slide level2">
<h2>Single-Marker: Special Cases</h2>
<ul>
<li>Rare variants: Fisher’s exact or Firth logistic to handle small counts/separation.</li>
<li>Gene-level: burden/collapsing or SKAT for sets of rare variants.</li>
<li>Family designs: TDT/FBAT for stratification-robust association.</li>
</ul>
</section>
<section id="basic-qc-pipeline-variant-level" class="slide level2">
<h2>Basic QC Pipeline (Variant-level)</h2>
<ul>
<li>Call rate/missingness (e.g., variant missingness &lt; 2%).</li>
<li>Hardy–Weinberg equilibrium in controls (e.g., P &gt; 1e−6), mindful of true deviations.</li>
<li>Minor allele frequency threshold (e.g., MAF ≥ 0.01 unless rare-variant methods used).</li>
<li>Differential missingness across case/control; strand/allele checks.</li>
</ul>
</section>
<section id="basic-qc-pipeline-sample-level" class="slide level2">
<h2>Basic QC Pipeline (Sample-level)</h2>
<ul>
<li>Sample call rate; sex checks from X chr; heterozygosity outliers.</li>
<li>Relatedness/duplicates via IBD; ancestry via PCA; remove outliers or adjust with PCs.</li>
<li>Duplicates/cryptic relatedness: retain one per pair or use mixed models.</li>
</ul>
</section>
<section id="demo-simulated-single-marker-test" class="slide level2">
<h2>Demo: Simulated Single-Marker Test</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.9053</td>
<td style="text-align: right;">0.0810</td>
<td style="text-align: right;">-11.1739</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">G</td>
<td style="text-align: right;">0.3797</td>
<td style="text-align: right;">0.0855</td>
<td style="text-align: right;">4.4390</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">0.7500</td>
<td style="text-align: right;">0.0641</td>
<td style="text-align: right;">11.7074</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="hwe-and-allele-counts-quick-checks" class="slide level2">
<h2>HWE and Allele Counts (Quick Checks)</h2>
<ul>
<li>For a bi-allelic SNP, with counts <span class="math inline">\((n_{AA}, n_{Aa}, n_{aa})\)</span>, test HWE via <span class="math inline">\(\chi^2\)</span>: <span class="math inline">\(\displaystyle X^2=\sum_{g\in\{AA,Aa,aa\}} \frac{(n_g - N \hat p_g)^2}{N\hat p_g}\)</span> with <span class="math inline">\(\hat p_A=(2n_{AA}+n_{Aa})/(2N)\)</span> and <span class="math inline">\(\hat p_g\)</span> from HWE.</li>
<li>Prefer exact tests for small <span class="math inline">\(N\)</span> or rare variants; compute in controls to avoid case-driven deviations.</li>
</ul>
</section>
<section id="haplotype-association-setup" class="slide level2">
<h2>Haplotype Association: Setup</h2>
<ul>
<li>Unphased genotypes induce ambiguity in haplotypes; EM estimates haplotype frequencies under HWE.</li>
<li>E-step: compute <span class="math inline">\(P(\text{haplotype pair}\mid \text{genotype}, p^{(t)})\)</span> per person; M-step: update haplotype frequencies by expected counts.</li>
<li>Association: use haplotype dosages as covariates in regression; sliding windows or gene-based haplotypes; consider LD and multiple testing.</li>
</ul>
</section>
<section id="em-demo-two-snp-haplotype-frequencies" class="slide level2">
<h2>EM Demo: Two-SNP Haplotype Frequencies</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Haplotype</th>
<th style="text-align: right;">True</th>
<th style="text-align: right;">EM_Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ab</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.3981</td>
</tr>
<tr class="even">
<td style="text-align: left;">aB</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.0959</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ab</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.2469</td>
</tr>
<tr class="even">
<td style="text-align: left;">AB</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.2591</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ld-from-estimated-haplotypes" class="slide level2">
<h2>LD From Estimated Haplotypes</h2>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">pB1</th>
<th style="text-align: right;">pB2</th>
<th style="text-align: right;">D</th>
<th style="text-align: right;">r2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ab</td>
<td style="text-align: right;">0.506</td>
<td style="text-align: right;">0.355</td>
<td style="text-align: right;">0.0795</td>
<td style="text-align: right;">0.1103</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="summary-key-takeaways" class="slide level2">
<h2>Summary &amp; Key Takeaways</h2>
<ul>
<li>Likelihood optimization: Newton–Raphson (score/Hessian), Gradient Descent/SGD (scalable), and EM (latent-data) are core tools.</li>
<li>EM for ABO gene frequencies: initialization affects speed; log-likelihood increases monotonically until convergence.</li>
<li>Linkage: two-point LOD and unknown phase via EM; multipoint mapping framed as an HMM for efficient inference with missing data.</li>
<li>LD basics: D, D′, and r connect haplotypes to correlation; explains tag–causal attenuation in association.</li>
<li>Association today: single-marker linear/logistic tests, haplotype tests via EM, and basic variant/sample QC.</li>
<li>Next: population structure (PCs), mixed models (LMM/GLMM), and GWAS-scale thresholds, power, and imputation in later lectures.</li>
</ul>


</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>