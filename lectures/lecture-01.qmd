---
title: "Lecture 01: Introduction and Foundations"
subtitle: PUBH 8878, Statistical Genetics
format: 
    revealjs:
        theme: [default, "custom.scss"]
        slide-number: true
        chalkboard: true
        html-math-method: katex
execute:
  freeze: auto
  echo: true
  warning: true
engine: knitr
knitr:
  opts_chunk: 
    R.options:
      width: 80
---

```{r, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(ggplot2)
library(viridis)
library(htmltools)
```

## About the Instructors

::: {layout="[100, 70, 66.5]"}
![Dr. Keith Crandall](https://publichealth.gwu.edu/sites/g/files/zaxdzs4586/files/styles/d07/public/2023-02/keith-crandall-up-2014-jmc_3352lowres.jpeg)

![Dr. Ali Rahnavard](https://publichealth.gwu.edu/sites/g/files/zaxdzs4586/files/styles/d07/public/2024-11/ali_rahnavard_102024.jpg)

![Chiraag Gohel](https://chiraaggohel.com/favicon.jpeg)
:::

## Introductions



## Course Site

[https://gwcbi.github.io/StatGen/](https://gwcbi.github.io/StatGen/)

<iframe src="https://gwcbi.github.io/StatGen/" width="100%" height="600px"></iframe>

## Zotero

![](images/paste-1.png)

## What is statistical genetics?

::: {layout-ncol="3"}
![Population Genetics](https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Darwin%27s_finches_by_Gould.jpg/1590px-Darwin%27s_finches_by_Gould.jpg)

![Genetic Epidemiology](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41576-022-00478-5/MediaObjects/41576_2022_478_Fig2_HTML.png)

![Quantitative Genetics](https://brightspotcdn.byu.edu/dims4/default/6658c6f/2147483647/strip/true/crop/1602x2400+0+0/resize/534x800!/quality/90/?url=https%3A%2F%2Fbrigham-young-brightspot-us-east-2.s3.us-east-2.amazonaws.com%2F9b%2Faf%2F9f5a135aaaf234b6420456b7312c%2Fbradley-measure.jpg)
:::

## A statistical geneticist may want to know

::: incremental
1.  Is there a genetic component contributing to the total variance of these traits?
2.  Is the genetic component of the traits driven by a few genes located on a particular chromosome, or are there many genes scattered across many chromosomes? How many genes are involved and is this a scientifically sensible question?
3.  Are the genes detected protein-coding genes, or are there also noncoding genes involved in gene regulation?
4.  How is the strength of the signals captured in a statistical analysis related to the two types of genes? What fraction of the total genetic variation is allocated to both types of genes?
5.  What are the frequencies of the genes in the sample? Are the frequencies associated with the magnitude of their effects on the traits?
6.  What is the mode of action of the genes?
:::

## A statistical geneticist may want to know

::: incremental
7.  What proportion of the genetic variance estimated in 1 can be explained by the discovered genes?
8.  Given the information on the set of genes carried by an individual, will a genetic score constructed before observing the trait help with early diagnosis and prevention?
9.  How should the predictive ability of the score be measured?
10. Are there other non-genetic factors that affect the traits, such as smoking behavior, alcohol consumption, blood pressure measurements, body mass index and level of physical exercise?
11. Could the predictive ability of the genetic score be improved by incorporation of these non-genetic sources of information, either additively or considering interactions? What is the relative contribution from the different sources of information?
:::

## What does the data look like?

**Family/Pedigree Studies**

![Family/Pedigree Studies](https://www.genome.gov/sites/default/files/media/images/tg/Pedigree.jpg)

## What does the data look like?

**Genome-Wide Association Studies (GWAS)**

![Genome-Wide Association Studies](https://upload.wikimedia.org/wikipedia/commons/4/4f/Manhattan_plot_from_a_GWAS_of_kidney_stone_disease.png){width="60%"}

## Core abstractions for quantitative biology

1.  **Model-Building**
    -   Formulate generative models linking genotype, environment, and phenotype (e.g., linear mixed, Bayesian hierarchical, non-parametric kernels).
    -   Encode biological structure: linkage & LD, population stratification, dominance/epistasis, multi-omics priors.
    -   Balance realism and tractability to enable scalable computation on genome-scale data.

![](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41467-021-25756-4/MediaObjects/41467_2021_25756_Fig1_HTML.png)

## Core abstractions for quantitative biology

2.  **Inference**
    -   Estimate unknown parameters and latent effects via likelihood maximisation, EM, MCMC, or SGD
    -   Quantify uncertainty with standard errors, posterior intervals, and credible sets
    -   Control false discoveries across millions of tests with FDR/Q-value, permutation, and empirical-Bayes shrinkage.

![](https://www.cs.auckland.ac.nz/~georgy/research/texture/thesis-html/img133.png)

## Core abstractions for quantitative biology

3.  **Prediction**
    -   Use fitted models for out-of-sample trait prediction: BLUP/GBLUP, ridge/lasso/elastic-net, Bayesian whole-genome regressions, random forests, neural nets.
    -   Evaluate accuracy (MSE, AUC), bias–variance trade-off, calibration, and portability across ancestries or cell types.
    -   Translate genomic predictions into actionable scores for breeding, risk stratification, and drug-target prioritisation.

![](https://www.cell.com/cms/10.1016/j.xgen.2024.100523/asset/29efca68-0928-4eed-94b9-9799e7cedda2/main.assets/gr5_lrg.jpg)

## Core abstractions for quantitative biology

4.  **Interpretation & Validation**
    -   Integrate functional annotations, eQTL, and single-cell data to refine biological mechanisms.
    -   Perform replication, cross-cohort meta-analysis, and sensitivity analyses to population assumptions.
    -   Communicate findings with clear visualisations and reproducible workflows (R/Bioconductor, Git, notebooks).

::: {layout="[1.5, -.2 ,1, -.2 ,2]" layout-valign="center"}
![](https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Nature_journal_logo.svg/1200px-Nature_journal_logo.svg.png)

![](https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Jupyter_logo.svg/1200px-Jupyter_logo.svg.png)

![](https://www.bioconductor.org/images/logo/png/bioconductor_logo_rgb.png)
:::

## Some vocabulary

-   **Trait/Phenotype**: A measurable characteristic of an organism, such as height, weight, or disease status.
-   **Genotype**: The genetic constitution of an individual, often represented by specific alleles at particular loci.
-   **Allele**: A variant form of a gene that can exist at a specific locus on a chromosome.
-   **Locus**: A specific, fixed position on a chromosome where a particular gene or genetic marker is located.
-   **Polymorphism**: The occurrence of two or more genetically determined forms in a population, such as single nucleotide polymorphisms (SNPs) or copy number variations (CNVs).
-   **Genetic Marker**: A specific DNA sequence with a known location on a chromosome that can be used to identify individuals or species, often used in genetic mapping or association studies.
-   **Linkage Disequilibrium (LD)**: The non-random association of alleles at different loci, indicating that certain allele combinations occur together more frequently than expected by chance.
-   **Heritability**: The proportion of phenotypic variance in a trait that can be attributed to genetic variance, often estimated through twin or family studies.

## Some vocabulary

-   **Genome-Wide Association Study (GWAS)**: A study that looks for associations between genetic variants across the genome and specific traits or diseases in a large population.
-   **Polygenic Score (PGS)**: A score that aggregates the effects of multiple genetic variants to predict an individual's genetic predisposition to a trait or disease.
-   **Quantitative Trait Locus (QTL)**: A region of the genome that is associated with a quantitative trait, often identified through linkage or association mapping.
-   **Epistasis**: The interaction between genes where the effect of one gene is modified by one or more other genes, influencing the expression of a trait.\
-   **Epigenetics**: The study of heritable changes in gene expression that do not involve changes to the underlying DNA sequence, often influenced by environmental factors.
-   **Functional Annotation**: The process of identifying the functional elements in the genome, such as genes, regulatory regions, and non-coding RNAs, and understanding their roles in biological processes.

## Probability Refresher

### Random Variables and Distributions

::: incremental
- **Random Variable**: $X: \Omega \to \mathbb{R}$ -- A function mapping sample space $\Omega$ to real numbers
- **Discrete RV**: $X \in \{x_1, x_2, \ldots\}$ (e.g., genotype counts, number of mutations)
  - **Probability Mass Function (PMF)**: $p_X(x) = P(X = x)$
  - **Cumulative Distribution Function (CDF)**: $F_X(x) = P(X \leq x) = \sum_{x_i \leq x} p_X(x_i)$
- **Continuous RV**: $X \in \mathbb{R}$ or interval (e.g., gene expression, quantitative traits)  
  - **Probability Density Function (PDF)**: $f_X(x)$ where $P(a < X < b) = \int_a^b f_X(x) dx$
  - **Cumulative Distribution Function (CDF)**: $F_X(x) = P(X \leq x) = \int_{-\infty}^x f_X(t) dt$
- **Key Properties**: $F_X(-\infty) = 0$, $F_X(\infty) = 1$, $f_X(x) = \frac{d}{dx}F_X(x)$
:::

## Probability Refresher

### Key Distributions in Statistical Genetics

::: {layout-ncol="2"}

**Binomial Distribution**
$$X \sim \text{Binomial}(n, p)$$
$$P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}$$

Used for: Allele counts, genotype frequencies

**Normal Distribution**
$$X \sim N(\mu, \sigma^2)$$
$$f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} e^{-\frac{(x-\mu)^2}{2\sigma^2}}$$

Used for: Quantitative traits, effect sizes
:::

## Probability Refresher

### Expected Value and Variance

::: incremental
- **Expected Value**: $E[X] = \sum x \cdot P(X = x)$ (discrete) or $E[X] = \int x f(x) dx$ (continuous)
- **Variance**: $\text{Var}(X) = E[(X - E[X])^2] = E[X^2] - (E[X])^2$
- **Standard Error**: $\text{SE} = \frac{\sigma}{\sqrt{n}}$ (uncertainty in sample estimates)
- **Central Limit Theorem**: Sample means approach normality as $n \to \infty$
:::

## Probability Refresher

### Conditional Probability and Independence

::: incremental
- **Conditional Probability**: $P(A|B) = \frac{P(A \cap B)}{P(B)}$
- **Bayes' Theorem**: $P(A|B) = \frac{P(B|A)P(A)}{P(B)}$
- **Independence**: $P(A \cap B) = P(A) \cdot P(B)$ iff $A$ and $B$ are independent
:::

## Early work in the field

::: {layout="[70, 30]"}
![](https://cdn.kastatic.org/ka-perseus-images/b966bcd0e55933e24836c4afe4a2a9889247579c.png)

![](https://cdn.kastatic.org/ka-perseus-images/97ef4b490d977c359786b040ead67b9cdaeac1aa.png)
:::

## Genetics, statistics, and eugenics, have always been closely linked

::: {layout="[35, 65]"}
![Standard eugenics scheme of descent](https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/PSM_V60_D232_Standard_eugenics_scheme_of_descent.png/960px-PSM_V60_D232_Standard_eugenics_scheme_of_descent.png)

![Francis Galton and his work, "Inquires into Human Faculty and its Development"](images/galton.png)
:::

## The ethics of genetics and genomics is/(was) of great importance!

![](images/nhgri_ethics.png)

## Parameter Estimation

-   Imagine a geneticist is studying **allele ages** (i.e., how many generations ago an allele arose via mutation) under a simplified model where new mutations arise randomly and uniformly over a fixed window — say, the last $\theta$ generations.
-   We could model $\theta \sim \textsf{Uniform}(0, \theta)$.
-   We have our observed sample $\{x_1,x_2, \ldots, x_n\}$, ages in generations of $n$ observed alleles.
    -   For concreteness, let our sample be $\{0, 1, 8, 4, 3, 1, 1, 5\}$.
-   How should we estimate $\theta$ ?

::: fragment
```{r, echo = F}
#| layout-ncol: 2

mom_estimator <- function(sample) {
    return(2 * mean(sample))
}

# Function to generate MLE estimator for Uniform(0, theta)
mle_estimator <- function(sample) {
    return(max(sample))
}

simulate_estimators <- function(theta = 1, n = 10, n_sim = 1000) {
    mom_estimates <- numeric(n_sim)
    mle_estimates <- numeric(n_sim)

    for (i in 1:n_sim) {
        sample <- runif(n, 0, theta)
        mom_estimates[i] <- mom_estimator(sample)
        mle_estimates[i] <- mle_estimator(sample)
    }

    return(list(
        mom = mom_estimates,
        mle = mle_estimates
    ))
}

n_simulations <- 5000
theta_true <- 10

n_demo_1 <- 10
n_demo_2 <- 1000
demo_results_1 <- simulate_estimators(theta_true, n_demo_1, n_simulations)
demo_results_2 <- simulate_estimators(theta_true, n_demo_2, n_simulations)

demo_data_1 <- data.frame(
    MOM = demo_results_1$mom,
    MLE = demo_results_1$mle
) %>%
    pivot_longer(everything(), names_to = "estimator", values_to = "estimate")

demo_data_2 <- data.frame(
    MOM = demo_results_2$mom,
    MLE = demo_results_2$mle
) %>%
    pivot_longer(everything(), names_to = "estimator", values_to = "estimate")
ggplot(demo_data_1, aes(x = estimate, fill = estimator)) +
    geom_histogram(alpha = 0.7, position = "identity", bins = 50) +
    geom_vline(xintercept = theta_true, linetype = "dashed", color = "red", linewidth = 1) +
    labs(
        title = paste0("Distribution of Estimates (n =", n_demo_1, ")"),
        x = "Estimate", y = "Frequency"
    ) +
    theme_minimal()

ggplot(demo_data_2, aes(x = estimate, fill = estimator)) +
    geom_histogram(alpha = 0.7, position = "identity", bins = 50) +
    geom_vline(xintercept = theta_true, linetype = "dashed", color = "red", linewidth = 1) +
    labs(
        title = paste0("Distribution of Estimates (n =", n_demo_2, ")"),
        x = "Estimate", y = "Frequency"
    ) +
    theme_minimal()
```
:::

## Importance of statistical theory

-   Understanding random variables, sampling distributions, and bias/variance of estimators helps motivate biological questions, and understand how they can be answered
-   Let y be the expression of a trait, G be the additive contribution of genetic variables, and an environmental value E;
-   What assumptions do we make via the following models?

::::: {layout="[44, -12, 44]"}
::: column
\begin{align}

y &= G + E \\
y &= \beta_0 + \beta_1 G + \beta_2 E + \epsilon \\
y &= \beta_0 + \beta_1 G + \beta_2 E + \epsilon, \quad \epsilon \sim N(0, \sigma^2) \\
y &= \beta_0 + \beta_1 G + \beta_2 E + \beta_3 \left(G \times E\right) + \epsilon, \quad \epsilon \sim N(0, \sigma^2)

\end{align}
:::

::: column
![](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fsj.tpj.6500085/MediaObjects/41397_2002_Article_BF6500085_Fig1_HTML.jpg)
:::
:::::

## Molecular Genetics

![](https://s3.amazonaws.com/libapps/accounts/14039/images/karyotype-human-female.jpg)

## Genetic Variants

![](https://upload.wikimedia.org/wikipedia/commons/3/37/Single_nucleotide_polymorphism_substitution_mutation_diagram_-_cytosine_to_thymine.png)

## The sampling distribution of a random variable

-   A random variable is a function that assigns a numerical value to each outcome in a sample space.
-   A probability distribution describes how the probabilities are distributed over the values of the random variable.
-   The likelihood function is a function of the parameters of a statistical model given specific observed data.

## Modeling

-   Imagine that we have a sample size of $n$ unrelated haploid individuals from some population
-   We want to estimate allele frequencies for a biallelic SNP, sy A/a
-   In our sample, we observe $x$ individuals with allele A and $n - x$ individuals with allele a
-   Let $p$ be the frequency of allele A and $q = 1 - p$ be the frequency of allele a

$$Pr(X = x| n, p) = \binom{n}{x} p^x q^{n - x}$$

-   Lets say we observe $n = 27$ and $x = 11$. How do we estimate $p$?

## Maximum Likelihood Estimator

Our likelihood function for $p$ is 
$$
L(P|x = 11, n = 27) = {27 \choose 11} p^{11} q^{27-11}
$$

::: columns
::: {.column width = "50%"}

```{r mle-plot-core}
n <- 27
x <- 11
p_seq <- seq(0, 1, length.out = 200)
likelihood <- dbinom(x, n, p_seq)
plot <- ggplot(
    data.frame(p = p_seq, likelihood = likelihood),
    aes(x = p, y = likelihood)
) +
    geom_line(linewidth = 1) +
    labs(
        x = "Probability of Success (p)",
        y = "Likelihood",
        title = "Binomial Likelihood Function"
    ) +
    geom_vline(
        xintercept = x / n,
        color = "red",
        linetype = "dashed"
    ) +
    theme_light(base_size = 18) +
    theme(panel.grid = element_blank())
```
:::

::: {.column width="50%"}
```{r, echo = F}
plot
```
:::

::::

## Building One-Locus Likelihood Functions

### The General Framework

::: incremental
- **Genetic Data**: Observed phenotypes/genotypes from individuals or families
- **Genetic Model**: Hypotheses about mode of inheritance, penetrance, allele frequencies
- **Likelihood Function**: $L(\boldsymbol{\theta} | \text{data}) = P(\text{data} | \boldsymbol{\theta})$
- **Parameters** $\boldsymbol{\theta}$: May include allele frequencies, penetrance values, recombination rates
:::

## Building One-Locus Likelihood Functions

### Example 1: Dominant Disease Model

Consider a rare dominant disease in a family pedigree:

::: {layout-ncol="2"}

**Family Data**
- Parents: Affected father, unaffected mother
- 4 offspring: 2 affected, 2 unaffected
- Disease allele frequency: $p$ (rare, so $p \approx 0$)

**Likelihood Construction**
1. **Parental genotypes**: $Dd \times dd$ 
2. **Expected offspring ratio**: 1:1 (affected:unaffected)
3. **Observed data**: 2 affected, 2 unaffected
4. **Likelihood**: $L(p) = \binom{4}{2} \left(\frac{1}{2}\right)^2 \left(\frac{1}{2}\right)^2 = \frac{6}{16}$

:::

## Building One-Locus Likelihood Functions

### Example 2: Penetrance Model

Disease with reduced penetrance:

::: incremental
- **Genotype-specific risks**: $P(\text{disease} | DD) = f_2$, $P(\text{disease} | Dd) = f_1$, $P(\text{disease} | dd) = f_0$
- **Observed data**: $n$ individuals, $k$ affected
- **Genotype frequencies**: Hardy-Weinberg proportions $p^2, 2pq, q^2$
- **Population disease risk**: $K = p^2 f_2 + 2pq f_1 + q^2 f_0$
:::

$$L(p, f_0, f_1, f_2) = \binom{n}{k} K^k (1-K)^{n-k}$$

## Building One-Locus Likelihood Functions

### Example 3: Family-Based Likelihood

Nuclear family with 2 parents, 3 offspring:

::: columns
::: {.column width="50%"}

```{r, echo = TRUE, eval = FALSE}
# Genotype probabilities for parents
parent_probs <- function(p, genotype) {
  case_when(
    genotype == "AA" ~ p^2,
    genotype == "Aa" ~ 2*p*(1-p),
    genotype == "aa" ~ (1-p)^2
  )
}

# Offspring probability given parents
offspring_prob <- function(p1_geno, p2_geno, 
                          offspring_geno) {
  # Mendelian transmission probabilities
  # Implementation depends on parental genotypes
}
```

:::

::: {.column width="50%"}

**Likelihood Components**
- $L_{\text{parents}} = P(G_1, G_2 | p)$
- $L_{\text{offspring}} = \prod_{i=1}^3 P(G_i | G_1, G_2)$
- **Total**: $L(p) = L_{\text{parents}} \times L_{\text{offspring}}$

**Interpretation**: Peak likelihood value gives MLE for allele frequency

:::
::::

## Building One-Locus Likelihood Functions

### Likelihood Surfaces and Interpretation

```{r, echo = FALSE}
# Generate likelihood surface for penetrance model
p_vals <- seq(0.01, 0.5, length.out = 50)
f1_vals <- seq(0.1, 1.0, length.out = 50)

# Example data: 100 individuals, 15 affected, assuming f0=0, f2=1
n <- 100
k <- 15

likelihood_surface <- expand.grid(p = p_vals, f1 = f1_vals) %>%
  mutate(
    K = p^2 * 1 + 2 * p * (1-p) * f1 + (1-p)^2 * 0,
    log_likelihood = dbinom(k, n, K, log = TRUE)
  )

ggplot(likelihood_surface, aes(x = p, y = f1, fill = log_likelihood)) +
  geom_tile() +
  geom_contour(aes(z = log_likelihood), color = "white", alpha = 0.7) +
  scale_fill_viridis_c(name = "Log\nLikelihood") +
  labs(
    x = "Allele Frequency (p)",
    y = "Penetrance (f₁)",
    title = "Likelihood Surface: Dominant Model with Reduced Penetrance"
  ) +
  theme_minimal(base_size = 14)
```

## Building One-Locus Likelihood Functions

### Key Principles for Likelihood Construction

::: incremental
1. **Start with the data**: What did you observe?
2. **Specify the model**: Mode of inheritance, penetrance assumptions
3. **Write conditional probabilities**: $P(\text{data} | \text{parameters})$
4. **Account for ascertainment**: How were families/individuals selected?
5. **Maximize or explore**: Find MLE or examine likelihood surface
6. **Interpret biologically**: What do parameter estimates tell us about the genetics?
:::

## Modeling, but make it bayesian

-   Let's say we have run a previous experiment and observed $n = 20$ individuals with allele A and $x = 3$ individuals with allele A
-   We can use this information to inform our prior distribution for $p$

::::::::: r-stack
::: {.fragment .fade-in-then-out}
```{r}
p <- seq(0, 1, length.out = 1000)
# Prior (Beta distribution from previous experiment)
prior <- dbeta(p, 3 + 1, 17 + 1)
# Likelihood (Beta distribution from current data)
likelihood <- dbeta(p, 11 + 1, 16 + 1)
# Posterior (Beta distribution combining both)
posterior <- dbeta(p, 14 + 1, 33 + 1)
# Combine into a data frame
plot_data <- data.frame(
    p = rep(p, 3),
    density = c(prior, likelihood, posterior),
    type = rep(c("Prior", "Likelihood", "Posterior"), each = length(p))
)
# Add flat prior distribution
flat_prior <- dbeta(p, 1, 1)
flat_posterior <- dbeta(p, 12, 17)
plot_data <- rbind(
    plot_data,
    data.frame(
        p = rep(p, 3),
        density = c(flat_prior, likelihood, flat_posterior),
        type = rep(c("Prior", "Likelihood", "Posterior"), each = length(p))
    )
)
# Add a column to distinguish between informative and flat scenarios
plot_data$scenario <- c(rep("Informative", 3000), rep("Flat", 3000))
```
:::

:::::: {.fragment .fade-in-then-out}
::::: columns
::: {.column width="50%"}
```{r}
p1 <- ggplot(
    plot_data %>% filter(scenario == "Informative"),
    aes(x = p, y = density, color = type)
) +
    geom_line(linewidth = 2) +
    geom_vline(xintercept = 11 / 27, linetype = "dashed", color = "red") +
    labs(
        x = "Allele Frequency (p)",
        y = "Density",
        title = "Bayesian Update with Informative Prior"
    ) +
    scale_color_viridis_d() +
    theme_minimal(base_size = 15)
```
:::

::: {.column width="50%"}
```{r}
p2 <- ggplot(
  plot_data %>% filter(scenario == "Flat"),
  aes(x = p, y = density, color = type, linetype = type)
) +
  geom_line(linewidth = 2) +
  scale_linetype_manual(values = c("Prior" = "dotted", "Likelihood" = "solid", "Posterior" = "dashed")) +
  geom_vline(xintercept = 11 / 27, linetype = "dotdash", color = "red") +
  labs(
    x = "Allele Frequency (p)",
    y = "Density",
    title = "Bayesian Update with Flat Prior"
  ) +
  theme_minimal(base_size = 15) +
  scale_color_viridis_d() +
  annotate("text",
    x = 0.7, y = max(flat_posterior) * 0.8,
    label = "Likelihood ≈ Posterior", color = "gray30"
  )
```
:::
:::::
::::::

::: fragment
```{r, echo = F}
#| layout-ncol: 2
#| fig.height: 8
p1
p2
```
:::
:::::::::

## Modeling, but make it Bayesian

```{r, echo = F}
img(src = knitr::include_graphics("scripts/_output/sequential_bayesian_update.gif"), alt = 'Bayesian updating')
```

## Mendel's Laws

::::: columns
::: {.column width="50%"}
**Mendel’s First Law (Segregation)**: One allele of each parent is randomly and independently selected, with probability 1/2 for transmission to the offspring; the alleles unite randomly to form the offspring’s genotype.

**Mendel’s Second Law (Independent Assortment)**: The alleles underlying two or more different traits are transmitted to offspring independently of each other; the transmission of each trait separately follows the first law of segregation.
:::

::: {.column width="50%"}
![](https://upload.wikimedia.org/wikipedia/commons/8/8e/Intermediate_inheritance_P_-_F1_-_F2.png){width="100%"}
:::
:::::

## Genetic Models

### Mendelian

::: {.callout title="Dominant"}
$$P(Y = 1 | DD) = P(Y = 1 | Dd) = 1$$ $$P(Y = 1 | dd) = 0$$
:::

::: {.callout title="Recessive"}
$$P(Y = 1 | DD) = 1$$ $$P(Y = 1 | Dd) = P(Y = 1 | dd) = 0$$
:::

These models are not reasonable for non rare/mendelian diseases

## Penetrance

A genetic model is of **reduced penetrance** if the probability of disease is less than 1 for individuals with a disease genotype

-   Recessive: $P(Y = 1 | DD) < 1$
-   Dominant: $P(Y = 1 | DD) < 1, P(Y = 1 | Dd) < 1$

## Continuous penetrance functions

What is the difference in what these two plots are showing?

::: {layout-ncol="2"}
![](images/penetrance-01.png)

![](images/penetrance-02.jpg)
:::

[From Goodrich, J. K et al. (2021), “Determinants of penetrance and variable expressivity in monogenic metabolic conditions across 77,184 exomes,” Nature Communications, Nature Publishing Group, 12, 3505.]{.aside style="font-size:.6em;"}

## Mode of Inheritance

For quantitative traits, there exist four modes of inheritance:

1.  Dominant, when only one copy of the allele is required to induce an effect on the disease phenotype
2.  Recessive, when two copies of the allele are required to induce an effect on the disease phenotype
3.  Additive, when the effect of the allele is proportional to the number of copies present
4.  Codominant, when the effect of the allele is equal to the sum of the effects of each copy

# DETOUR

## Generalized Linear Models

::: {.callout title="Simple Linear Model"}
$$
y_i = \beta_0 + \beta_1 x_i + \epsilon_i
$$
:::

::: {.callout title="Generalized Linear Model"}
$$
g(y_i) = \beta_0 + \beta_1 x_i + \epsilon_i
$$

Where

-   $g(\cdot)$ is a link function that relates the linear predictor to the mean of the response variable
-   $V(\cdot)$ is a variance function that relates the mean of the response variable to its variance
:::

# Population Genetics

## Estimating Allele Frequencies

Consider a sample of $n$ individuals, and let

-   $n_{AA}$ be the number of individuals with genotype $AA$
-   $n_{Aa}$ be the number of individuals with genotype $Aa$
-   $n_{aa}$ be the number of individuals with genotype $aa$

1.  What is $n_{AA} + n_{Aa} + n_{aa}$?
2.  What is the frequency of allele $A$ in the population?
3.  How many alleles are there in total?
4.  What is the frequency of allele $a$ in the population?
5.  What is the standard error of the allele frequency estimate?

## Population Substructure

![Shriner, D., Adeyemo, A., Ramos, E., Chen, G., and Rotimi, C. N. (2011), [“Mapping of disease-associated variants in admixed populations,”](https://doi.org/10.1186/gb-2011-12-5-223) Genome Biology, BioMed Central, 12, 1–8.](https://media.springernature.com/full/springer-static/image/art%3A10.1186%2Fgb-2011-12-5-223/MediaObjects/13059_2011_Article_2523_Fig1_HTML.jpg)

## Hardy-Weinberg Equilibrium

![Khan Academy](https://cdn.kastatic.org/ka-perseus-images/010efe45f63d8da65c92d7af25c503c0bc91f105.png)

## Testing for HWE {auto-animate="true"}

1.  Estimate allele frequencies from the sample
2.  Estimate $\hat{p}$, the frequency of allele A
3.  Calculate expected genotype frequencies under HWE
4.  Compare observed and expected genotype frequencies using a statistical test (e.g., Pearson goodness-of-fit test)

## Testing for HWE {auto-animate="true"}

1.  **Estimate allele frequencies from the sample**
2.  Estimate $\hat{p}$, the frequency of allele A
3.  Calculate expected genotype frequencies under HWE
4.  Compare observed and expected genotype frequencies using a statistical test (e.g., Pearson goodness-of-fit test)

```{r}
n <- 212
n_AA <- 175
n_Aa <- 33
n_aa <- 4
```

## Testing for HWE {auto-animate="true"}

1.  Estimate allele frequencies from the sample
2.  **Estimate** $\hat{p}$, the frequency of allele A
3.  Calculate expected genotype frequencies under HWE
4.  Compare observed and expected genotype frequencies using a statistical test (e.g., Pearson goodness-of-fit test)

```{r}
n <- 212
n_AA <- 175
n_Aa <- 33
n_aa <- 4

p_hat <- (2* n_AA + n_Aa) / (2*n)
p_hat
```

## Testing for HWE {auto-animate="true"}

1.  Estimate allele frequencies from the sample
2.  Estimate $\hat{p}$, the frequency of allele A
3.  **Calculate expected genotype frequencies under HWE**
4.  Compare observed and expected genotype frequencies using a statistical test (e.g., Pearson goodness-of-fit test)

```{r}
n <- 212
n_AA <- 175
n_Aa <- 33
n_aa <- 4

p_hat <- (2* n_AA + n_Aa) / (2*n)
p_hat

e_AA <- round(n * p_hat^2)
e_Aa <- round(2 * n * p_hat * (1 - p_hat))
e_aa <- round(n * (1 - p_hat)^2)
c(e_AA, e_Aa, e_aa)
```

## Testing for HWE {auto-animate="true"}

1.  Estimate allele frequencies from the sample
2.  Estimate $\hat{p}$, the frequency of allele A
3.  Calculate expected genotype frequencies under HWE
4.  **Compare observed and expected genotype frequencies using a statistical test (e.g., Pearson goodness-of-fit test)**

```{r}
n <- 212
n_AA <- 175
n_Aa <- 33
n_aa <- 4

p_hat <- (2* n_AA + n_Aa) / (2*n)
p_hat

e_AA <- round(n * p_hat^2)
e_Aa <- round(2 * n * p_hat * (1 - p_hat))
e_aa <- round(n * (1 - p_hat)^2)
c(e_AA, e_Aa, e_aa)

observed <- c(n_AA, n_Aa, n_aa)
expected <- c(e_AA, e_Aa, e_aa)
test_stat <- sum((observed - expected)^2 / expected)
pchisq(test_stat, df = 1, lower.tail = FALSE)
```