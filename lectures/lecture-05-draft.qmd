---
title: "Lecture 05: Generalized Linear Models and Regression in Genetics"
subtitle: PUBH 8878, Statistical Genetics
format: 
    revealjs:
        theme: [default, "custom.scss"]
        slide-number: true
        chalkboard: true
        html-math-method: katex
execute:
  freeze: auto
  echo: true
  warning: true
engine: knitr
knitr:
  opts_chunk: 
    R.options:
      width: 80
draft: true
---

```{r, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(ggplot2)
library(viridis)
library(htmltools)
```

## Generalized Linear Models

::: {.callout title="Simple Linear Model"}
$$
y_i = \beta_0 + \beta_1 x_i + \epsilon_i
$$
:::

::: {.callout title="Generalized Linear Model"}
$$
g(y_i) = \beta_0 + \beta_1 x_i + \epsilon_i
$$

Where

-   $g(\cdot)$ is a link function that relates the linear predictor to the mean of the response variable
-   $V(\cdot)$ is a variance function that relates the mean of the response variable to its variance
:::

## Applications in Statistical Genetics

### Binary Traits (Disease Status)
- **Logistic Regression**: $\log\left(\frac{p}{1-p}\right) = \beta_0 + \beta_1 G$
- **Probit Regression**: $\Phi^{-1}(p) = \beta_0 + \beta_1 G$

### Count Data (Number of Mutations)
- **Poisson Regression**: $\log(\lambda) = \beta_0 + \beta_1 G$
- **Negative Binomial**: For overdispersed count data

### Quantitative Traits
- **Linear Mixed Models**: For related individuals
- **Robust Regression**: For outlier-resistant estimation

## Link Functions in Genetics

::: {layout-ncol="2"}

### Common Link Functions

| **Response** | **Link Function** | **Formula** |
|--------------|------------------|-------------|
| Binary | Logit | $\log\left(\frac{p}{1-p}\right)$ |
| Binary | Probit | $\Phi^{-1}(p)$ |
| Count | Log | $\log(\mu)$ |
| Continuous | Identity | $\mu$ |

### Genetic Applications

- **Case-Control Studies**: Logistic regression
- **Family Studies**: Mixed models with random effects
- **Rare Variants**: Zero-inflated models
- **Expression Data**: Log-normal or gamma distributions

:::

## From Simple Association to Complex Models

### Single SNP Association
$$\text{logit}(P(\text{disease})) = \beta_0 + \beta_1 \cdot \text{SNP}$$

### Multiple SNPs + Covariates
$$\text{logit}(P(\text{disease})) = \beta_0 + \sum_{j=1}^p \beta_j \cdot \text{SNP}_j + \sum_{k=1}^q \gamma_k \cdot \text{Covariate}_k$$

### Population Structure Correction
$$\text{logit}(P(\text{disease})) = \beta_0 + \beta_1 \cdot \text{SNP} + \sum_{l=1}^L \delta_l \cdot \text{PC}_l$$

## Next Steps

In upcoming lectures, we will explore:

- **Genome-Wide Association Studies (GWAS)**: Applying GLMs at scale
- **Mixed Models**: Accounting for population structure and relatedness
- **Polygenic Risk Scores**: Combining effects across many variants
- **Bayesian Approaches**: Alternative to frequentist GLM framework