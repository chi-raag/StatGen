---
title: "Lecture 01: Introduction and Foundations"
subtitle: PUBH 8878, Statistical Genetics
format:
    revealjs:
        theme: [default, custom.scss]
        slide-number: true
    pptx: 
        output-file: "lecture-01.pptx"
---

```{r, message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(ggplot2)
```

## Introductions

## About Me

::: {layout="[30, 70]"}

![My dog Rosie and I](https://chiraaggohel.com/favicon.jpeg)

* I'm Chiraag Gohel, a 4th Year PhD student in the Department of Biostatistics and Bioinformatics at George Washington University.
* My interests are in the modeling of high-dimensional 'omics data
* I play a lot of squash

:::

## Syllabus

## What is statistical genetics?

::: {layout-ncol="3"}


![Population Genetics](https://upload.wikimedia.org/wikipedia/commons/thumb/a/ae/Darwin%27s_finches_by_Gould.jpg/1590px-Darwin%27s_finches_by_Gould.jpg)

![Genetic Epidemiology](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41576-022-00478-5/MediaObjects/41576_2022_478_Fig2_HTML.png)

![Quantitative Genetics](https://brightspotcdn.byu.edu/dims4/default/6658c6f/2147483647/strip/true/crop/1602x2400+0+0/resize/534x800!/quality/90/?url=https%3A%2F%2Fbrigham-young-brightspot-us-east-2.s3.us-east-2.amazonaws.com%2F9b%2Faf%2F9f5a135aaaf234b6420456b7312c%2Fbradley-measure.jpg)
:::

## A statistical geneticist may want to know

::: incremental
1.  Is there a genetic component contributing to the total variance of these traits?
2.  Is the genetic component of the traits driven by a few genes located on a particular chromosome, or are there many genes scattered across many chromosomes? How many genes are involved and is this a scientifically sensible question?
3.  Are the genes detected protein-coding genes, or are there also noncoding genes involved in gene regulation?
4.  How is the strength of the signals captured in a statistical analysis related to the two types of genes? What fraction of the total genetic variation is allocated to both types of genes?
5.  What are the frequencies of the genes in the sample? Are the frequencies associated with the magnitude of their effects on the traits?
6.  What is the mode of action of the genes?
:::

## A statistical geneticist may want to know

::: incremental
7.  What proportion of the genetic variance estimated in 1 can be explained by the discovered genes?
8.  Given the information on the set of genes carried by an individual, will a genetic score constructed before observing the trait help with early diagnosis and prevention?
9.  How should the predictive ability of the score be measured?
10. Are there other non-genetic factors that affect the traits, such as smoking behavior, alcohol consumption, blood pressure measurements, body mass index and level of physical exercise?
11. Could the predictive ability of the genetic score be improved by incorporation of these non-genetic sources of information, either additively or considering interactions? What is the relative contribution from the different sources of information?
:::

## What does the data look like?

**Family/Pedigree Studies**

![Family/Pedigree Studies](https://www.genome.gov/sites/default/files/media/images/tg/Pedigree.jpg)

## What does the data look like?

**Genome-Wide Association Studies (GWAS)**

![Genome-Wide Association Studies](https://upload.wikimedia.org/wikipedia/commons/4/4f/Manhattan_plot_from_a_GWAS_of_kidney_stone_disease.png)

## Core abstractions for quantitative biology

1. **Model-Building**
    - Formulate generative models linking genotype, environment, and phenotype (e.g., linear mixed, Bayesian hierarchical, non-parametric kernels).
    - Encode biological structure: linkage & LD, population stratification, dominance/epistasis, multi-omics priors.
    - Balance realism and tractability to enable scalable computation on genome-scale data.

![](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fs41467-021-25756-4/MediaObjects/41467_2021_25756_Fig1_HTML.png)

## Core abstractions for quantitative biology

2. **Inference**
    - Estimate unknown parameters and latent effects via likelihood maximisation, EM, MCMC, or SGD
    - Quantify uncertainty with standard errors, posterior intervals, and credible sets
    - Control false discoveries across millions of tests with FDR/Q-value, permutation, and empirical-Bayes shrinkage.

![](https://www.cs.auckland.ac.nz/~georgy/research/texture/thesis-html/img133.png)

## Core abstractions for quantitative biology

3. **Prediction**
    - Use fitted models for out-of-sample trait prediction: BLUP/GBLUP, ridge/lasso/elastic-net, Bayesian whole-genome regressions, random forests, neural nets.
    - Evaluate accuracy (MSE, AUC), bias–variance trade-off, calibration, and portability across ancestries or cell types.
    - Translate genomic predictions into actionable scores for breeding, risk stratification, and drug-target prioritisation.

![](https://www.cell.com/cms/10.1016/j.xgen.2024.100523/asset/29efca68-0928-4eed-94b9-9799e7cedda2/main.assets/gr5_lrg.jpg)

## Core abstractions for quantitative biology

4. **Interpretation & Validation**
    - Integrate functional annotations, eQTL, and single-cell data to refine biological mechanisms.
    - Perform replication, cross-cohort meta-analysis, and sensitivity analyses to population assumptions.
    - Communicate findings with clear visualisations and reproducible workflows (R/Bioconductor, Git, notebooks).

::: {layout="[1.5, -.2 ,1, -.2 ,2]" layout-valign="center"}

![](https://upload.wikimedia.org/wikipedia/commons/thumb/d/db/Nature_journal_logo.svg/1200px-Nature_journal_logo.svg.png)

![](https://upload.wikimedia.org/wikipedia/commons/thumb/3/38/Jupyter_logo.svg/1200px-Jupyter_logo.svg.png)

![](https://www.bioconductor.org/images/logo/png/bioconductor_logo_rgb.png)

:::

## Some vocabulary

* **Trait/Phenotype**: A measurable characteristic of an organism, such as height, weight, or disease status.
* **Genotype**: The genetic constitution of an individual, often represented by specific alleles at particular loci.
* **Allele**: A variant form of a gene that can exist at a specific locus on a chromosome.
* **Locus**: A specific, fixed position on a chromosome where a particular gene or genetic marker is located.
* **Polymorphism**: The occurrence of two or more genetically determined forms in a population, such as single nucleotide polymorphisms (SNPs) or copy number variations (CNVs).
* **Genetic Marker**: A specific DNA sequence with a known location on a chromosome that can be used to identify individuals or species, often used in genetic mapping or association studies.
* **Linkage Disequilibrium (LD)**: The non-random association of alleles at different loci, indicating that certain allele combinations occur together more frequently than expected by chance.
* **Heritability**: The proportion of phenotypic variance in a trait that can be attributed to genetic variance, often estimated through twin or family studies.

## Some vocabulary

* **Genome-Wide Association Study (GWAS)**: A study that looks for associations between genetic variants across the genome and specific traits or diseases in a large population.
* **Polygenic Score (PGS)**: A score that aggregates the effects of multiple genetic variants to predict an individual's genetic predisposition to a trait or disease.
* **Quantitative Trait Locus (QTL)**: A region of the genome that is associated with a quantitative trait, often identified through linkage or association mapping.
* **Epistasis**: The interaction between genes where the effect of one gene is modified by one or more other genes, influencing the expression of a trait.  
* **Epigenetics**: The study of heritable changes in gene expression that do not involve changes to the underlying DNA sequence, often influenced by environmental factors.
* **Functional Annotation**: The process of identifying the functional elements in the genome, such as genes, regulatory regions, and non-coding RNAs, and understanding their roles in biological processes.

## Early work in the field


::: {layout="[70, 30]"}

![](https://cdn.kastatic.org/ka-perseus-images/b966bcd0e55933e24836c4afe4a2a9889247579c.png)

![](https://cdn.kastatic.org/ka-perseus-images/97ef4b490d977c359786b040ead67b9cdaeac1aa.png)

:::

## Genetics, statistics, and eugenics, have always been closely linked

::: {layout="[35, 65]"}

![Standard eugenics scheme of descent](https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/PSM_V60_D232_Standard_eugenics_scheme_of_descent.png/960px-PSM_V60_D232_Standard_eugenics_scheme_of_descent.png)

![Francis Galton and his work, "Inquires into Human Faculty and its Development"](images/galton.png)

:::

## The ethics of genetics and genomics is/(was) of great importance!

![](images/nhgri_ethics.png)

## Parameter Estimation

* Imagine a geneticist is studying **allele ages** (i.e., how many generations ago an allele arose via mutation) under a simplified model where new mutations arise randomly and uniformly over a fixed window — say, the last $\theta$ generations.
* We could model $\theta \sim \textsf{Uniform}(0, \theta)$.
* We have our observed sample $\{x_1,x_2, \ldots, x_n\}$, ages in generations of $n$ observed alleles.
    * For concreteness, let our sample be $\{0, 1, 8, 4, 3, 1, 1, 5\}$.
* How should we estimate $\theta$ ?


```{r}
#| layout-ncol: 2

mom_estimator <- function(sample) {
  return(2 * mean(sample))
}

# Function to generate MLE estimator for Uniform(0, theta)
mle_estimator <- function(sample) {
  return(max(sample))
}

simulate_estimators <- function(theta = 1, n = 10, n_sim = 1000) {
  mom_estimates <- numeric(n_sim)
  mle_estimates <- numeric(n_sim)
  
  for (i in 1:n_sim) {
    sample <- runif(n, 0, theta)
    mom_estimates[i] <- mom_estimator(sample)
    mle_estimates[i] <- mle_estimator(sample)
  }
  
  return(list(
    mom = mom_estimates,
    mle = mle_estimates
  ))
}

n_simulations <- 5000
theta_true <- 10

n_demo_1 <- 10
n_demo_2 <- 1000
demo_results_1 <- simulate_estimators(theta_true, n_demo_1, n_simulations)
demo_results_2 <- simulate_estimators(theta_true, n_demo_2, n_simulations)

demo_data_1 <- data.frame(
  MOM = demo_results_1$mom,
  MLE = demo_results_1$mle
) %>%
  pivot_longer(everything(), names_to = "estimator", values_to = "estimate")

demo_data_2 <- data.frame(
  MOM = demo_results_2$mom,
  MLE = demo_results_2$mle
) %>%
  pivot_longer(everything(), names_to = "estimator", values_to = "estimate")
ggplot(demo_data_1, aes(x = estimate, fill = estimator)) +
  geom_histogram(alpha = 0.7, position = "identity", bins = 50) +
  geom_vline(xintercept = theta_true, linetype = "dashed", color = "red", size = 1) +
  labs(title = paste0("Distribution of Estimates (n =", n_demo_1, ")"),
       x = "Estimate", y = "Frequency") +
  theme_minimal()

ggplot(demo_data_2, aes(x = estimate, fill = estimator)) +
  geom_histogram(alpha = 0.7, position = "identity", bins = 50) +
  geom_vline(xintercept = theta_true, linetype = "dashed", color = "red", size = 1) +
  labs(title = paste0("Distribution of Estimates (n =", n_demo_2, ")"),
       x = "Estimate", y = "Frequency") +
  theme_minimal()
```

## Importance of statistical theory

* Understanding random variables, sampling distributions, and bias/variance of estimators helps motivate biological questions, and understand how they can be answered
* Let y be the expression of a trait, G be the additive contribution of genetic variables, and an environmental value E;
* What assumptions do we make via the following models?

::: {layout="[44, -12, 44]"}

:::: {.column}

\begin{align}

y &= G + E \\
y &= \beta_0 + \beta_1 G + \beta_2 E + \epsilon \\
y &= \beta_0 + \beta_1 G + \beta_2 E + \epsilon, \quad \epsilon \sim N(0, \sigma^2) \\
y &= \beta_0 + \beta_1 G + \beta_2 E + \beta_3 \left(G \times E\right) + \epsilon, \quad \epsilon \sim N(0, \sigma^2)

\end{align}

::::

:::: {.column}

![](https://media.springernature.com/full/springer-static/image/art%3A10.1038%2Fsj.tpj.6500085/MediaObjects/41397_2002_Article_BF6500085_Fig1_HTML.jpg)

::::

:::

## Molecular Genetics

![](https://s3.amazonaws.com/libapps/accounts/14039/images/karyotype-human-female.jpg)

## Genetic Variants

![](https://upload.wikimedia.org/wikipedia/commons/3/37/Single_nucleotide_polymorphism_substitution_mutation_diagram_-_cytosine_to_thymine.png)

## The sampling distribution of a random variable

* A random variable is a function that assigns a numerical value to each outcome in a sample space.
* A probability distribution describes how the probabilities are distributed over the values of the random variable.
* The likelihood function is a function of the parameters of a statistical model given specific observed data.

## Modeling

- Imagine that we have a sample size of $n$ unrelated haploid individuals from some population
- We want to estimate allele frequencies for a biallelic SNP, sy A/a
- In our sample, we observe $x$ individuals with allele A and $n - x$ individuals with allele a
- Let $p$ be the frequency of allele A and $q = 1 - p$ be the frequency of allele a

$$Pr(X = x| n, p) = \binom{n}{x} p^x q^{n - x}$$

- Lets say we observe $n = 27$ and $x = 11$. How do we estimate $p$?

## Modeling, but make it bayesian

- Let's say we have run a previous experiment and observed $n = 20$ individuals with allele A and $x = 3$ individuals with allele A
- We can use this information to inform our prior distribution for $p$

```{r}
#| layout-ncol: 2
# Create data for prior, likelihood, and posterior distributions
p <- seq(0, 1, length.out = 1000)

# Prior (Beta distribution from previous experiment)
prior <- dbeta(p, 3 + 1, 17 + 1)

# Likelihood (Beta distribution from current data)
likelihood <- dbeta(p, 11 + 1, 16 + 1)

# Posterior (Beta distribution combining both)
posterior <- dbeta(p, 14 + 1, 33 + 1)

# Combine into a data frame
plot_data <- data.frame(
    p = rep(p, 3),
    density = c(prior, likelihood, posterior),
    type = rep(c("Prior", "Likelihood", "Posterior"), each = length(p))
)

# Add flat prior distribution
flat_prior <- dbeta(p, 1, 1)
flat_posterior <- dbeta(p, 12, 17)

plot_data <- rbind(
    plot_data,
    data.frame(
        p = rep(p, 3),
        density = c(flat_prior, likelihood, flat_posterior),
        type = rep(c("Prior", "Likelihood", "Posterior"), each = length(p))
    )
)

# Add a column to distinguish between informative and flat scenarios
plot_data$scenario <- c(rep("Informative", 3000), rep("Flat", 3000))

# Create plot
# Plot for informative prior
p1 <- ggplot(plot_data %>% filter(scenario == "Informative"), 
             aes(x = p, y = density, color = type)) +
    geom_line(size = 1) +
    geom_vline(xintercept = 11/27, linetype = "dashed", color = "red") +
    labs(x = "Allele Frequency (p)", 
         y = "Density",
         title = "Bayesian Update with Informative Prior") +
    theme_minimal()

# Plot for flat prior with different line types for overlapping curves
p2 <- ggplot(plot_data %>% filter(scenario == "Flat"), 
             aes(x = p, y = density, color = type, linetype = type)) +
    geom_line(size = 1) +
    scale_linetype_manual(values = c("Prior" = "dotted", "Likelihood" = "solid", "Posterior" = "dashed")) +
    geom_vline(xintercept = 11/27, linetype = "dotdash", color = "red") +
    labs(x = "Allele Frequency (p)", 
         y = "Density",
         title = "Bayesian Update with Flat Prior") +
    theme_minimal() +
    annotate("text", x = 0.7, y = max(flat_posterior) * 0.8, 
             label = "Likelihood ≈ Posterior", size = 3, color = "gray30")

print(p1)
print(p2)
```